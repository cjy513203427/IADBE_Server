/home/jinyao/anaconda3/envs/IADB/bin/python /home/jinyao/PycharmProjects/IADBE/train_test_mvtec_fastflow.py
2024-05-08 12:16:29,291 - INFO - ================== Processing dataset: screw ==================
2024-05-08 12:16:29,291 - INFO - Initializing Fastflow model.
2024-05-08 12:16:29,292 - INFO - ================== Start training for dataset: screw ==================
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-05-08 12:16:29,387 - WARNING - No implementation of `configure_transforms` was provided in the Lightning model. Using default transforms from the base class. This may not be suitable for your use case. Please override `configure_transforms` in your model.
2024-05-08 12:16:29,388 - INFO - Found the dataset.
You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-05-08 12:16:29,606 - INFO - Loading pretrained weights from url (https://download.pytorch.org/models/resnet18-5c106cde.pth)
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name                  | Type                     | Params
-------------------------------------------------------------------
0 | loss                  | FastflowLoss             | 0
1 | _transform            | Compose                  | 0
2 | normalization_metrics | MinMax                   | 0
3 | image_threshold       | F1AdaptiveThreshold      | 0
4 | pixel_threshold       | F1AdaptiveThreshold      | 0
5 | image_metrics         | AnomalibMetricCollection | 0
6 | pixel_metrics         | AnomalibMetricCollection | 0
7 | model                 | FastflowModel            | 7.7 M
-------------------------------------------------------------------
3.5 M     Trainable params
4.2 M     Non-trainable params
7.7 M     Total params
30.678    Total estimated model params size (MB)
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Epoch 0:   0%|          | 0/2 [00:00<?, ?it/s] /home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/core/module.py:494: You called `self.log('train_loss', ..., logger=True)` but have no logger configured. You can enable one by doing `Trainer(logger=ALogger(...))`
Epoch 0: 100%|██████████| 2/2 [00:08<00:00,  0.25it/s, train_loss_step=2.02e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.97it/s]
Epoch 1: 100%|██████████| 2/2 [00:07<00:00,  0.27it/s, train_loss_step=1.5e+5, pixel_AUROC=0.927, pixel_PRO=0.183, train_loss_epoch=2.27e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.77it/s]
Epoch 2: 100%|██████████| 2/2 [00:06<00:00,  0.29it/s, train_loss_step=1e+5, pixel_AUROC=0.932, pixel_PRO=0.165, train_loss_epoch=1.7e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.68it/s]
Epoch 3: 100%|██████████| 2/2 [00:07<00:00,  0.28it/s, train_loss_step=5.47e+4, pixel_AUROC=0.925, pixel_PRO=0.215, train_loss_epoch=1.2e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.77it/s]
Epoch 4: 100%|██████████| 2/2 [00:07<00:00,  0.28it/s, train_loss_step=1.12e+4, pixel_AUROC=0.910, pixel_PRO=0.257, train_loss_epoch=7.27e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.72it/s]
Epoch 4: 100%|██████████| 2/2 [00:13<00:00,  0.14it/s, train_loss_step=1.12e+4, pixel_AUROC=0.897, pixel_PRO=0.228, train_loss_epoch=2.83e+4]
2024-05-08 12:17:42,164 - INFO - Training took 72.33 seconds
2024-05-08 12:17:42,165 - INFO - ================== Start testing for dataset: screw ==================
2024-05-08 12:17:42,166 - INFO - Found the dataset.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'test_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Testing DataLoader 0: 100%|██████████| 1/1 [00:26<00:00,  0.04it/s]
2024-05-08 12:18:12,283 - INFO - Testing took 29.950374841690063 seconds
Throughput (batch_size=256) : 5.342170201398768 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.6585366129875183     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.8965010046958923     │
│         pixel_PRO         │    0.22782260179519653    │
└───────────────────────────┴───────────────────────────┘
2024-05-08 12:18:12,364 - INFO - ================== Processing dataset: pill ==================
2024-05-08 12:18:12,364 - INFO - Initializing Fastflow model.
2024-05-08 12:18:12,364 - INFO - ================== Start training for dataset: pill ==================
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-05-08 12:18:12,374 - WARNING - No implementation of `configure_transforms` was provided in the Lightning model. Using default transforms from the base class. This may not be suitable for your use case. Please override `configure_transforms` in your model.
2024-05-08 12:18:12,375 - INFO - Found the dataset.
2024-05-08 12:18:12,501 - INFO - Loading pretrained weights from url (https://download.pytorch.org/models/resnet18-5c106cde.pth)
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name                  | Type                     | Params
-------------------------------------------------------------------
0 | loss                  | FastflowLoss             | 0
1 | _transform            | Compose                  | 0
2 | normalization_metrics | MinMax                   | 0
3 | image_threshold       | F1AdaptiveThreshold      | 0
4 | pixel_threshold       | F1AdaptiveThreshold      | 0
5 | image_metrics         | AnomalibMetricCollection | 0
6 | pixel_metrics         | AnomalibMetricCollection | 0
7 | model                 | FastflowModel            | 7.7 M
-------------------------------------------------------------------
3.5 M     Trainable params
4.2 M     Non-trainable params
7.7 M     Total params
30.678    Total estimated model params size (MB)
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Epoch 0:   0%|          | 0/2 [00:00<?, ?it/s] /home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/core/module.py:494: You called `self.log('train_loss', ..., logger=True)` but have no logger configured. You can enable one by doing `Trainer(logger=ALogger(...))`
Epoch 0: 100%|██████████| 2/2 [00:06<00:00,  0.30it/s, train_loss_step=2.06e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.66it/s]
Epoch 1: 100%|██████████| 2/2 [00:06<00:00,  0.29it/s, train_loss_step=1.62e+5, pixel_AUROC=0.757, pixel_PRO=0.702, train_loss_epoch=2.33e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  2.95it/s]
Epoch 2: 100%|██████████| 2/2 [00:06<00:00,  0.30it/s, train_loss_step=1.19e+5, pixel_AUROC=0.821, pixel_PRO=0.693, train_loss_epoch=1.82e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.54it/s]
Epoch 3: 100%|██████████| 2/2 [00:06<00:00,  0.30it/s, train_loss_step=7.97e+4, pixel_AUROC=0.827, pixel_PRO=0.685, train_loss_epoch=1.39e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.36it/s]
Epoch 4: 100%|██████████| 2/2 [00:06<00:00,  0.31it/s, train_loss_step=4.01e+4, pixel_AUROC=0.835, pixel_PRO=0.666, train_loss_epoch=9.8e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.54it/s]
Epoch 5: 100%|██████████| 2/2 [00:06<00:00,  0.30it/s, train_loss_step=1.17e+4, pixel_AUROC=0.869, pixel_PRO=0.679, train_loss_epoch=5.99e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.53it/s]
Epoch 6: 100%|██████████| 2/2 [00:06<00:00,  0.30it/s, train_loss_step=-2.16e+4, pixel_AUROC=0.885, pixel_PRO=0.689, train_loss_epoch=2.45e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.67it/s]
Epoch 7: 100%|██████████| 2/2 [00:06<00:00,  0.30it/s, train_loss_step=-5.37e+4, pixel_AUROC=0.894, pixel_PRO=0.669, train_loss_epoch=-6.57e+3]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.53it/s]
Epoch 8: 100%|██████████| 2/2 [00:06<00:00,  0.30it/s, train_loss_step=-7.92e+4, pixel_AUROC=0.899, pixel_PRO=0.661, train_loss_epoch=-3.69e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.53it/s]
Epoch 9: 100%|██████████| 2/2 [00:06<00:00,  0.31it/s, train_loss_step=-1.01e+5, pixel_AUROC=0.906, pixel_PRO=0.671, train_loss_epoch=-6.72e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.55it/s]
Epoch 10: 100%|██████████| 2/2 [00:06<00:00,  0.31it/s, train_loss_step=-1.25e+5, pixel_AUROC=0.901, pixel_PRO=0.658, train_loss_epoch=-9.35e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.56it/s]
Epoch 11: 100%|██████████| 2/2 [00:06<00:00,  0.31it/s, train_loss_step=-1.45e+5, pixel_AUROC=0.898, pixel_PRO=0.645, train_loss_epoch=-1.16e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.53it/s]
Epoch 12: 100%|██████████| 2/2 [00:06<00:00,  0.31it/s, train_loss_step=-1.52e+5, pixel_AUROC=0.911, pixel_PRO=0.650, train_loss_epoch=-1.37e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.54it/s]
Epoch 13: 100%|██████████| 2/2 [00:06<00:00,  0.31it/s, train_loss_step=-1.88e+5, pixel_AUROC=0.897, pixel_PRO=0.641, train_loss_epoch=-1.55e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.42it/s]
Epoch 14: 100%|██████████| 2/2 [00:06<00:00,  0.30it/s, train_loss_step=-1.86e+5, pixel_AUROC=0.907, pixel_PRO=0.650, train_loss_epoch=-1.7e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.42it/s]
Epoch 15: 100%|██████████| 2/2 [00:06<00:00,  0.31it/s, train_loss_step=-2.16e+5, pixel_AUROC=0.919, pixel_PRO=0.668, train_loss_epoch=-1.86e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.51it/s]
Epoch 16: 100%|██████████| 2/2 [00:06<00:00,  0.31it/s, train_loss_step=-2.25e+5, pixel_AUROC=0.929, pixel_PRO=0.666, train_loss_epoch=-2.02e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.56it/s]
Epoch 17: 100%|██████████| 2/2 [00:06<00:00,  0.30it/s, train_loss_step=-2.48e+5, pixel_AUROC=0.917, pixel_PRO=0.657, train_loss_epoch=-2.18e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.57it/s]
Epoch 18: 100%|██████████| 2/2 [00:06<00:00,  0.30it/s, train_loss_step=-2.45e+5, pixel_AUROC=0.919, pixel_PRO=0.653, train_loss_epoch=-2.32e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.56it/s]
Epoch 18: 100%|██████████| 2/2 [00:14<00:00,  0.14it/s, train_loss_step=-2.45e+5, pixel_AUROC=0.921, pixel_PRO=0.656, train_loss_epoch=-2.46e+5]
2024-05-08 12:22:47,058 - INFO - Training took 274.45 seconds
2024-05-08 12:22:47,058 - INFO - ================== Start testing for dataset: pill ==================
2024-05-08 12:22:47,059 - INFO - Found the dataset.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Testing: |          | 0/? [00:00<?, ?it/s]/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'test_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Testing DataLoader 0: 100%|██████████| 1/1 [00:27<00:00,  0.04it/s]
2024-05-08 12:23:19,205 - INFO - Testing took 31.975895881652832 seconds
Throughput (batch_size=256) : 5.22268400604286 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.7659574151039124     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │     0.921451985836029     │
│         pixel_PRO         │    0.6564382314682007     │
└───────────────────────────┴───────────────────────────┘
2024-05-08 12:23:19,283 - INFO - ================== Processing dataset: capsule ==================
2024-05-08 12:23:19,283 - INFO - Initializing Fastflow model.
2024-05-08 12:23:19,283 - INFO - ================== Start training for dataset: capsule ==================
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-05-08 12:23:19,294 - WARNING - No implementation of `configure_transforms` was provided in the Lightning model. Using default transforms from the base class. This may not be suitable for your use case. Please override `configure_transforms` in your model.
2024-05-08 12:23:19,294 - INFO - Found the dataset.
2024-05-08 12:23:19,417 - INFO - Loading pretrained weights from url (https://download.pytorch.org/models/resnet18-5c106cde.pth)
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name                  | Type                     | Params
-------------------------------------------------------------------
0 | loss                  | FastflowLoss             | 0
1 | _transform            | Compose                  | 0
2 | normalization_metrics | MinMax                   | 0
3 | image_threshold       | F1AdaptiveThreshold      | 0
4 | pixel_threshold       | F1AdaptiveThreshold      | 0
5 | image_metrics         | AnomalibMetricCollection | 0
6 | pixel_metrics         | AnomalibMetricCollection | 0
7 | model                 | FastflowModel            | 7.7 M
-------------------------------------------------------------------
3.5 M     Trainable params
4.2 M     Non-trainable params
7.7 M     Total params
30.678    Total estimated model params size (MB)
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Epoch 0:   0%|          | 0/1 [00:00<?, ?it/s] /home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/core/module.py:494: You called `self.log('train_loss', ..., logger=True)` but have no logger configured. You can enable one by doing `Trainer(logger=ALogger(...))`
Epoch 0: 100%|██████████| 1/1 [00:08<00:00,  0.11it/s, train_loss_step=2.39e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.01it/s]
Epoch 1: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=2.09e+5, pixel_AUROC=0.836, pixel_PRO=0.284, train_loss_epoch=2.39e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.44it/s]
Epoch 2: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=1.84e+5, pixel_AUROC=0.858, pixel_PRO=0.409, train_loss_epoch=2.09e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.41it/s]
Epoch 3: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=1.59e+5, pixel_AUROC=0.882, pixel_PRO=0.492, train_loss_epoch=1.84e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.75it/s]
Epoch 4: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=1.36e+5, pixel_AUROC=0.897, pixel_PRO=0.490, train_loss_epoch=1.59e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.38it/s]
Epoch 5: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=1.11e+5, pixel_AUROC=0.902, pixel_PRO=0.470, train_loss_epoch=1.36e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.48it/s]
Epoch 6: 100%|██████████| 1/1 [00:08<00:00,  0.11it/s, train_loss_step=8.98e+4, pixel_AUROC=0.905, pixel_PRO=0.452, train_loss_epoch=1.11e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.64it/s]
Epoch 7: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=6.94e+4, pixel_AUROC=0.907, pixel_PRO=0.456, train_loss_epoch=8.98e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.45it/s]
Epoch 8: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=4.94e+4, pixel_AUROC=0.908, pixel_PRO=0.431, train_loss_epoch=6.94e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.02it/s]
Epoch 9: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=3.07e+4, pixel_AUROC=0.915, pixel_PRO=0.445, train_loss_epoch=4.94e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.43it/s]
Epoch 10: 100%|██████████| 1/1 [00:08<00:00,  0.11it/s, train_loss_step=1.39e+4, pixel_AUROC=0.918, pixel_PRO=0.390, train_loss_epoch=3.07e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.22it/s]
Epoch 11: 100%|██████████| 1/1 [00:08<00:00,  0.11it/s, train_loss_step=-3.1e+3, pixel_AUROC=0.920, pixel_PRO=0.374, train_loss_epoch=1.39e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.02it/s]
Epoch 12: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-1.96e+4, pixel_AUROC=0.923, pixel_PRO=0.363, train_loss_epoch=-3.1e+3]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.34it/s]
Epoch 13: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-3.53e+4, pixel_AUROC=0.923, pixel_PRO=0.369, train_loss_epoch=-1.96e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.59it/s]
Epoch 14: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-5.05e+4, pixel_AUROC=0.929, pixel_PRO=0.395, train_loss_epoch=-3.53e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.42it/s]
Epoch 15: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-6.4e+4, pixel_AUROC=0.918, pixel_PRO=0.396, train_loss_epoch=-5.05e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.91it/s]
Epoch 16: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-7.66e+4, pixel_AUROC=0.934, pixel_PRO=0.387, train_loss_epoch=-6.4e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.31it/s]
Epoch 17: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-8.99e+4, pixel_AUROC=0.935, pixel_PRO=0.415, train_loss_epoch=-7.66e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.30it/s]
Epoch 18: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-1.03e+5, pixel_AUROC=0.932, pixel_PRO=0.405, train_loss_epoch=-8.99e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.37it/s]
Epoch 19: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-1.17e+5, pixel_AUROC=0.937, pixel_PRO=0.430, train_loss_epoch=-1.03e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.28it/s]
Epoch 20: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-1.29e+5, pixel_AUROC=0.937, pixel_PRO=0.419, train_loss_epoch=-1.17e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.40it/s]
Epoch 21: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-1.39e+5, pixel_AUROC=0.936, pixel_PRO=0.423, train_loss_epoch=-1.29e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.42it/s]
Epoch 22: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-1.5e+5, pixel_AUROC=0.937, pixel_PRO=0.443, train_loss_epoch=-1.39e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.03it/s]
Epoch 22: 100%|██████████| 1/1 [00:16<00:00,  0.06it/s, train_loss_step=-1.5e+5, pixel_AUROC=0.934, pixel_PRO=0.434, train_loss_epoch=-1.5e+5]
2024-05-08 12:29:45,323 - INFO - Training took 385.80 seconds
2024-05-08 12:29:45,323 - INFO - ================== Start testing for dataset: capsule ==================
2024-05-08 12:29:45,325 - INFO - Found the dataset.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'test_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Testing DataLoader 0: 100%|██████████| 1/1 [00:24<00:00,  0.04it/s]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │     0.696449875831604     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.9343070983886719     │
│         pixel_PRO         │    0.43418559432029724    │
└───────────────────────────┴───────────────────────────┘
2024-05-08 12:30:14,995 - INFO - Testing took 29.511729955673218 seconds
Throughput (batch_size=256) : 4.472797772216835 FPS
2024-05-08 12:30:15,062 - INFO - ================== Processing dataset: carpet ==================
2024-05-08 12:30:15,062 - INFO - Initializing Fastflow model.
2024-05-08 12:30:15,063 - INFO - ================== Start training for dataset: carpet ==================
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-05-08 12:30:15,073 - WARNING - No implementation of `configure_transforms` was provided in the Lightning model. Using default transforms from the base class. This may not be suitable for your use case. Please override `configure_transforms` in your model.
2024-05-08 12:30:15,073 - INFO - Found the dataset.
2024-05-08 12:30:15,195 - INFO - Loading pretrained weights from url (https://download.pytorch.org/models/resnet18-5c106cde.pth)
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name                  | Type                     | Params
-------------------------------------------------------------------
0 | loss                  | FastflowLoss             | 0
1 | _transform            | Compose                  | 0
2 | normalization_metrics | MinMax                   | 0
3 | image_threshold       | F1AdaptiveThreshold      | 0
4 | pixel_threshold       | F1AdaptiveThreshold      | 0
5 | image_metrics         | AnomalibMetricCollection | 0
6 | pixel_metrics         | AnomalibMetricCollection | 0
7 | model                 | FastflowModel            | 7.7 M
-------------------------------------------------------------------
3.5 M     Trainable params
4.2 M     Non-trainable params
7.7 M     Total params
30.678    Total estimated model params size (MB)
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Epoch 0:   0%|          | 0/2 [00:00<?, ?it/s] /home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/core/module.py:494: You called `self.log('train_loss', ..., logger=True)` but have no logger configured. You can enable one by doing `Trainer(logger=ALogger(...))`
Epoch 0: 100%|██████████| 2/2 [00:11<00:00,  0.18it/s, train_loss_step=1.96e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.99it/s]
Epoch 1: 100%|██████████| 2/2 [00:10<00:00,  0.19it/s, train_loss_step=1.28e+5, pixel_AUROC=0.851, pixel_PRO=0.306, train_loss_epoch=2.36e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.08it/s]
Epoch 2: 100%|██████████| 2/2 [00:10<00:00,  0.19it/s, train_loss_step=7.61e+4, pixel_AUROC=0.911, pixel_PRO=0.485, train_loss_epoch=1.58e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.76it/s]
Epoch 3: 100%|██████████| 2/2 [00:10<00:00,  0.19it/s, train_loss_step=3.52e+4, pixel_AUROC=0.941, pixel_PRO=0.584, train_loss_epoch=9.69e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.09it/s]
Epoch 4: 100%|██████████| 2/2 [00:10<00:00,  0.19it/s, train_loss_step=2.29e+3, pixel_AUROC=0.952, pixel_PRO=0.609, train_loss_epoch=5.32e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.04it/s]
Epoch 5: 100%|██████████| 2/2 [00:10<00:00,  0.19it/s, train_loss_step=-2.63e+4, pixel_AUROC=0.958, pixel_PRO=0.617, train_loss_epoch=1.64e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.03it/s]
Epoch 6: 100%|██████████| 2/2 [00:10<00:00,  0.19it/s, train_loss_step=-4.82e+4, pixel_AUROC=0.959, pixel_PRO=0.617, train_loss_epoch=-1.32e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.10it/s]
Epoch 7: 100%|██████████| 2/2 [00:10<00:00,  0.19it/s, train_loss_step=-7.61e+4, pixel_AUROC=0.963, pixel_PRO=0.647, train_loss_epoch=-3.73e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.07it/s]
Epoch 8: 100%|██████████| 2/2 [00:10<00:00,  0.19it/s, train_loss_step=-9.76e+4, pixel_AUROC=0.965, pixel_PRO=0.641, train_loss_epoch=-6.34e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.10it/s]
Epoch 9: 100%|██████████| 2/2 [00:10<00:00,  0.19it/s, train_loss_step=-1.09e+5, pixel_AUROC=0.971, pixel_PRO=0.669, train_loss_epoch=-8.82e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.86it/s]
Epoch 10: 100%|██████████| 2/2 [00:10<00:00,  0.19it/s, train_loss_step=-1.25e+5, pixel_AUROC=0.974, pixel_PRO=0.685, train_loss_epoch=-1.06e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.93it/s]
Epoch 11: 100%|██████████| 2/2 [00:10<00:00,  0.19it/s, train_loss_step=-1.39e+5, pixel_AUROC=0.975, pixel_PRO=0.715, train_loss_epoch=-1.18e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.98it/s]
Epoch 12: 100%|██████████| 2/2 [00:10<00:00,  0.19it/s, train_loss_step=-1.51e+5, pixel_AUROC=0.976, pixel_PRO=0.700, train_loss_epoch=-1.33e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.01it/s]
Epoch 13: 100%|██████████| 2/2 [00:10<00:00,  0.19it/s, train_loss_step=-1.6e+5, pixel_AUROC=0.978, pixel_PRO=0.702, train_loss_epoch=-1.47e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.97it/s]
Epoch 14: 100%|██████████| 2/2 [00:10<00:00,  0.19it/s, train_loss_step=-1.76e+5, pixel_AUROC=0.979, pixel_PRO=0.695, train_loss_epoch=-1.58e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.09it/s]
Epoch 15: 100%|██████████| 2/2 [00:10<00:00,  0.19it/s, train_loss_step=-1.81e+5, pixel_AUROC=0.977, pixel_PRO=0.675, train_loss_epoch=-1.69e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.11it/s]
Epoch 16: 100%|██████████| 2/2 [00:10<00:00,  0.19it/s, train_loss_step=-1.94e+5, pixel_AUROC=0.979, pixel_PRO=0.697, train_loss_epoch=-1.8e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.12it/s]
Epoch 16: 100%|██████████| 2/2 [00:17<00:00,  0.11it/s, train_loss_step=-1.94e+5, pixel_AUROC=0.977, pixel_PRO=0.688, train_loss_epoch=-1.88e+5]
2024-05-08 12:35:16,568 - INFO - Training took 301.25 seconds
2024-05-08 12:35:16,568 - INFO - ================== Start testing for dataset: carpet ==================
2024-05-08 12:35:16,570 - INFO - Found the dataset.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'test_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Testing DataLoader 0: 100%|██████████| 1/1 [00:21<00:00,  0.05it/s]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.9337881207466125     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.9765380024909973     │
│         pixel_PRO         │    0.6875954866409302     │
└───────────────────────────┴───────────────────────────┘
2024-05-08 12:35:42,245 - INFO - Testing took 25.51506757736206 seconds
Throughput (batch_size=256) : 4.585525773947268 FPS
2024-05-08 12:35:42,310 - INFO - ================== Processing dataset: grid ==================
2024-05-08 12:35:42,310 - INFO - Initializing Fastflow model.
2024-05-08 12:35:42,311 - INFO - ================== Start training for dataset: grid ==================
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-05-08 12:35:42,321 - WARNING - No implementation of `configure_transforms` was provided in the Lightning model. Using default transforms from the base class. This may not be suitable for your use case. Please override `configure_transforms` in your model.
2024-05-08 12:35:42,322 - INFO - Found the dataset.
2024-05-08 12:35:42,442 - INFO - Loading pretrained weights from url (https://download.pytorch.org/models/resnet18-5c106cde.pth)
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name                  | Type                     | Params
-------------------------------------------------------------------
0 | loss                  | FastflowLoss             | 0
1 | _transform            | Compose                  | 0
2 | normalization_metrics | MinMax                   | 0
3 | image_threshold       | F1AdaptiveThreshold      | 0
4 | pixel_threshold       | F1AdaptiveThreshold      | 0
5 | image_metrics         | AnomalibMetricCollection | 0
6 | pixel_metrics         | AnomalibMetricCollection | 0
7 | model                 | FastflowModel            | 7.7 M
-------------------------------------------------------------------
3.5 M     Trainable params
4.2 M     Non-trainable params
7.7 M     Total params
30.678    Total estimated model params size (MB)
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Epoch 0:   0%|          | 0/2 [00:00<?, ?it/s] /home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/core/module.py:494: You called `self.log('train_loss', ..., logger=True)` but have no logger configured. You can enable one by doing `Trainer(logger=ALogger(...))`
Epoch 0: 100%|██████████| 2/2 [00:06<00:00,  0.31it/s, train_loss_step=1.96e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.33it/s]
Epoch 1: 100%|██████████| 2/2 [00:06<00:00,  0.30it/s, train_loss_step=1.38e+5, pixel_AUROC=0.487, pixel_PRO=0.470, train_loss_epoch=2.31e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  9.04it/s]
Epoch 2: 100%|██████████| 2/2 [00:06<00:00,  0.32it/s, train_loss_step=9.73e+4, pixel_AUROC=0.660, pixel_PRO=0.492, train_loss_epoch=1.64e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.88it/s]
Epoch 3: 100%|██████████| 2/2 [00:06<00:00,  0.30it/s, train_loss_step=6.81e+4, pixel_AUROC=0.744, pixel_PRO=0.139, train_loss_epoch=1.14e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  9.05it/s]
Epoch 4: 100%|██████████| 2/2 [00:06<00:00,  0.32it/s, train_loss_step=3.62e+4, pixel_AUROC=0.768, pixel_PRO=0.194, train_loss_epoch=8.48e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  9.04it/s]
Epoch 5: 100%|██████████| 2/2 [00:06<00:00,  0.31it/s, train_loss_step=1.28e+4, pixel_AUROC=0.794, pixel_PRO=0.197, train_loss_epoch=5e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.58it/s]
Epoch 6: 100%|██████████| 2/2 [00:06<00:00,  0.32it/s, train_loss_step=-2.89e+3, pixel_AUROC=0.782, pixel_PRO=0.191, train_loss_epoch=2.4e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  9.07it/s]
Epoch 7: 100%|██████████| 2/2 [00:05<00:00,  0.34it/s, train_loss_step=-3.2e+4, pixel_AUROC=0.805, pixel_PRO=0.180, train_loss_epoch=1.39e+3]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  9.08it/s]
Epoch 8: 100%|██████████| 2/2 [00:06<00:00,  0.33it/s, train_loss_step=-5.85e+4, pixel_AUROC=0.823, pixel_PRO=0.199, train_loss_epoch=-2.38e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  9.07it/s]
Epoch 9: 100%|██████████| 2/2 [00:06<00:00,  0.32it/s, train_loss_step=-6.7e+4, pixel_AUROC=0.840, pixel_PRO=0.244, train_loss_epoch=-4.58e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  9.08it/s]
Epoch 10: 100%|██████████| 2/2 [00:06<00:00,  0.32it/s, train_loss_step=-9.68e+4, pixel_AUROC=0.858, pixel_PRO=0.263, train_loss_epoch=-6.68e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  9.05it/s]
Epoch 11: 100%|██████████| 2/2 [00:06<00:00,  0.33it/s, train_loss_step=-1.23e+5, pixel_AUROC=0.883, pixel_PRO=0.284, train_loss_epoch=-87109.5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  9.04it/s]
Epoch 12: 100%|██████████| 2/2 [00:06<00:00,  0.32it/s, train_loss_step=-1.38e+5, pixel_AUROC=0.899, pixel_PRO=0.327, train_loss_epoch=-1.07e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  9.04it/s]
Epoch 13: 100%|██████████| 2/2 [00:06<00:00,  0.32it/s, train_loss_step=-1.46e+5, pixel_AUROC=0.907, pixel_PRO=0.339, train_loss_epoch=-1.27e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  9.03it/s]
Epoch 14: 100%|██████████| 2/2 [00:06<00:00,  0.31it/s, train_loss_step=-1.69e+5, pixel_AUROC=0.913, pixel_PRO=0.341, train_loss_epoch=-1.43e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  9.04it/s]
Epoch 15: 100%|██████████| 2/2 [00:06<00:00,  0.32it/s, train_loss_step=-1.69e+5, pixel_AUROC=0.917, pixel_PRO=0.360, train_loss_epoch=-1.56e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  9.06it/s]
Epoch 16: 100%|██████████| 2/2 [00:06<00:00,  0.33it/s, train_loss_step=-1.96e+5, pixel_AUROC=0.923, pixel_PRO=0.387, train_loss_epoch=-1.72e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.99it/s]
Epoch 17: 100%|██████████| 2/2 [00:06<00:00,  0.30it/s, train_loss_step=-1.85e+5, pixel_AUROC=0.932, pixel_PRO=0.414, train_loss_epoch=-1.82e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.65it/s]
Epoch 18: 100%|██████████| 2/2 [00:06<00:00,  0.33it/s, train_loss_step=-2.07e+5, pixel_AUROC=0.936, pixel_PRO=0.403, train_loss_epoch=-1.91e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.29it/s]
Epoch 19: 100%|██████████| 2/2 [00:06<00:00,  0.31it/s, train_loss_step=-2.24e+5, pixel_AUROC=0.937, pixel_PRO=0.408, train_loss_epoch=-2.02e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.83it/s]
Epoch 20: 100%|██████████| 2/2 [00:06<00:00,  0.31it/s, train_loss_step=-2.3e+5, pixel_AUROC=0.937, pixel_PRO=0.425, train_loss_epoch=-2.15e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  9.08it/s]
Epoch 21: 100%|██████████| 2/2 [00:06<00:00,  0.33it/s, train_loss_step=-2.34e+5, pixel_AUROC=0.945, pixel_PRO=0.442, train_loss_epoch=-2.24e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  9.05it/s]
Epoch 22: 100%|██████████| 2/2 [00:06<00:00,  0.33it/s, train_loss_step=-2.58e+5, pixel_AUROC=0.950, pixel_PRO=0.443, train_loss_epoch=-2.37e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  9.06it/s]
Epoch 23: 100%|██████████| 2/2 [00:06<00:00,  0.31it/s, train_loss_step=-2.7e+5, pixel_AUROC=0.954, pixel_PRO=0.461, train_loss_epoch=-2.48e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  9.07it/s]
Epoch 24: 100%|██████████| 2/2 [00:06<00:00,  0.33it/s, train_loss_step=-2.7e+5, pixel_AUROC=0.954, pixel_PRO=0.462, train_loss_epoch=-2.59e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  9.01it/s]
Epoch 25: 100%|██████████| 2/2 [00:06<00:00,  0.31it/s, train_loss_step=-2.84e+5, pixel_AUROC=0.959, pixel_PRO=0.491, train_loss_epoch=-2.68e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.63it/s]
Epoch 26: 100%|██████████| 2/2 [00:06<00:00,  0.31it/s, train_loss_step=-2.9e+5, pixel_AUROC=0.961, pixel_PRO=0.489, train_loss_epoch=-2.77e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  9.04it/s]
Epoch 27: 100%|██████████| 2/2 [00:06<00:00,  0.32it/s, train_loss_step=-2.91e+5, pixel_AUROC=0.962, pixel_PRO=0.492, train_loss_epoch=-2.87e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.91it/s]
Epoch 28: 100%|██████████| 2/2 [00:06<00:00,  0.32it/s, train_loss_step=-3.21e+5, pixel_AUROC=0.962, pixel_PRO=0.488, train_loss_epoch=-2.95e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  9.05it/s]
Epoch 29: 100%|██████████| 2/2 [00:06<00:00,  0.32it/s, train_loss_step=-2.95e+5, pixel_AUROC=0.965, pixel_PRO=0.514, train_loss_epoch=-3.04e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.73it/s]
Epoch 30: 100%|██████████| 2/2 [00:06<00:00,  0.32it/s, train_loss_step=-3.25e+5, pixel_AUROC=0.966, pixel_PRO=0.505, train_loss_epoch=-3.11e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.98it/s]
Epoch 31: 100%|██████████| 2/2 [00:06<00:00,  0.33it/s, train_loss_step=-3.26e+5, pixel_AUROC=0.965, pixel_PRO=0.491, train_loss_epoch=-3.19e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.99it/s]
Epoch 32: 100%|██████████| 2/2 [00:06<00:00,  0.32it/s, train_loss_step=-3.39e+5, pixel_AUROC=0.967, pixel_PRO=0.516, train_loss_epoch=-3.21e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  9.08it/s]
Epoch 33: 100%|██████████| 2/2 [00:06<00:00,  0.32it/s, train_loss_step=-3.33e+5, pixel_AUROC=0.969, pixel_PRO=0.524, train_loss_epoch=-3.3e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  9.08it/s]
Epoch 34: 100%|██████████| 2/2 [00:06<00:00,  0.33it/s, train_loss_step=-3.48e+5, pixel_AUROC=0.970, pixel_PRO=0.510, train_loss_epoch=-3.38e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  9.04it/s]
Epoch 35: 100%|██████████| 2/2 [00:06<00:00,  0.32it/s, train_loss_step=-3.57e+5, pixel_AUROC=0.970, pixel_PRO=0.504, train_loss_epoch=-3.47e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  9.09it/s]
Epoch 36: 100%|██████████| 2/2 [00:06<00:00,  0.32it/s, train_loss_step=-3.62e+5, pixel_AUROC=0.971, pixel_PRO=0.516, train_loss_epoch=-3.54e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  9.08it/s]
Epoch 37: 100%|██████████| 2/2 [00:06<00:00,  0.32it/s, train_loss_step=-3.55e+5, pixel_AUROC=0.970, pixel_PRO=0.535, train_loss_epoch=-3.58e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.75it/s]
Epoch 38: 100%|██████████| 2/2 [00:06<00:00,  0.33it/s, train_loss_step=-3.69e+5, pixel_AUROC=0.971, pixel_PRO=0.532, train_loss_epoch=-3.62e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.76it/s]
Epoch 39: 100%|██████████| 2/2 [00:06<00:00,  0.33it/s, train_loss_step=-3.79e+5, pixel_AUROC=0.973, pixel_PRO=0.548, train_loss_epoch=-3.69e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.62it/s]
Epoch 40: 100%|██████████| 2/2 [00:06<00:00,  0.33it/s, train_loss_step=-3.84e+5, pixel_AUROC=0.973, pixel_PRO=0.537, train_loss_epoch=-3.77e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.41it/s]
Epoch 41: 100%|██████████| 2/2 [00:06<00:00,  0.33it/s, train_loss_step=-3.71e+5, pixel_AUROC=0.973, pixel_PRO=0.529, train_loss_epoch=-3.86e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  9.04it/s]
Epoch 41: 100%|██████████| 2/2 [00:09<00:00,  0.20it/s, train_loss_step=-3.71e+5, pixel_AUROC=0.973, pixel_PRO=0.526, train_loss_epoch=-3.84e+5]
2024-05-08 12:42:42,812 - INFO - Training took 420.25 seconds
2024-05-08 12:42:42,812 - INFO - ================== Start testing for dataset: grid ==================
2024-05-08 12:42:42,814 - INFO - Found the dataset.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'test_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Testing DataLoader 0: 100%|██████████| 1/1 [00:12<00:00,  0.08it/s]
2024-05-08 12:42:57,554 - INFO - Testing took 14.598740816116333 seconds
Throughput (batch_size=256) : 5.34292655664464 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │     0.963241457939148     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.9726676344871521     │
│         pixel_PRO         │    0.5258516073226929     │
└───────────────────────────┴───────────────────────────┘
2024-05-08 12:42:57,608 - INFO - ================== Processing dataset: tile ==================
2024-05-08 12:42:57,609 - INFO - Initializing Fastflow model.
2024-05-08 12:42:57,609 - INFO - ================== Start training for dataset: tile ==================
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-05-08 12:42:57,619 - WARNING - No implementation of `configure_transforms` was provided in the Lightning model. Using default transforms from the base class. This may not be suitable for your use case. Please override `configure_transforms` in your model.
2024-05-08 12:42:57,619 - INFO - Found the dataset.
2024-05-08 12:42:57,746 - INFO - Loading pretrained weights from url (https://download.pytorch.org/models/resnet18-5c106cde.pth)
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name                  | Type                     | Params
-------------------------------------------------------------------
0 | loss                  | FastflowLoss             | 0
1 | _transform            | Compose                  | 0
2 | normalization_metrics | MinMax                   | 0
3 | image_threshold       | F1AdaptiveThreshold      | 0
4 | pixel_threshold       | F1AdaptiveThreshold      | 0
5 | image_metrics         | AnomalibMetricCollection | 0
6 | pixel_metrics         | AnomalibMetricCollection | 0
7 | model                 | FastflowModel            | 7.7 M
-------------------------------------------------------------------
3.5 M     Trainable params
4.2 M     Non-trainable params
7.7 M     Total params
30.678    Total estimated model params size (MB)
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Epoch 0:   0%|          | 0/1 [00:00<?, ?it/s] /home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/core/module.py:494: You called `self.log('train_loss', ..., logger=True)` but have no logger configured. You can enable one by doing `Trainer(logger=ALogger(...))`
Epoch 0: 100%|██████████| 1/1 [00:06<00:00,  0.15it/s, train_loss_step=2.33e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.03it/s]
Epoch 1: 100%|██████████| 1/1 [00:06<00:00,  0.16it/s, train_loss_step=2.02e+5, pixel_AUROC=0.565, pixel_PRO=0.683, train_loss_epoch=2.33e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.07it/s]
Epoch 2: 100%|██████████| 1/1 [00:06<00:00,  0.16it/s, train_loss_step=1.76e+5, pixel_AUROC=0.634, pixel_PRO=0.655, train_loss_epoch=2.02e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.97it/s]
Epoch 3: 100%|██████████| 1/1 [00:06<00:00,  0.15it/s, train_loss_step=1.53e+5, pixel_AUROC=0.691, pixel_PRO=0.648, train_loss_epoch=1.76e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.50it/s]
Epoch 4: 100%|██████████| 1/1 [00:06<00:00,  0.16it/s, train_loss_step=1.33e+5, pixel_AUROC=0.727, pixel_PRO=0.642, train_loss_epoch=1.53e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.05it/s]
Epoch 5: 100%|██████████| 1/1 [00:06<00:00,  0.16it/s, train_loss_step=1.17e+5, pixel_AUROC=0.750, pixel_PRO=0.598, train_loss_epoch=1.33e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.10it/s]
Epoch 6: 100%|██████████| 1/1 [00:06<00:00,  0.16it/s, train_loss_step=1e+5, pixel_AUROC=0.772, pixel_PRO=0.567, train_loss_epoch=1.17e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.07it/s]
Epoch 7: 100%|██████████| 1/1 [00:06<00:00,  0.16it/s, train_loss_step=8.59e+4, pixel_AUROC=0.781, pixel_PRO=0.559, train_loss_epoch=1e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.64it/s]
Epoch 8: 100%|██████████| 1/1 [00:06<00:00,  0.15it/s, train_loss_step=7.45e+4, pixel_AUROC=0.790, pixel_PRO=0.575, train_loss_epoch=8.59e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.02it/s]
Epoch 9: 100%|██████████| 1/1 [00:06<00:00,  0.15it/s, train_loss_step=6.24e+4, pixel_AUROC=0.785, pixel_PRO=0.571, train_loss_epoch=7.45e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.04it/s]
Epoch 10: 100%|██████████| 1/1 [00:06<00:00,  0.16it/s, train_loss_step=5.05e+4, pixel_AUROC=0.791, pixel_PRO=0.558, train_loss_epoch=6.24e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.62it/s]
Epoch 11: 100%|██████████| 1/1 [00:06<00:00,  0.15it/s, train_loss_step=4.03e+4, pixel_AUROC=0.787, pixel_PRO=0.548, train_loss_epoch=5.05e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.69it/s]
Epoch 12: 100%|██████████| 1/1 [00:06<00:00,  0.16it/s, train_loss_step=3.09e+4, pixel_AUROC=0.803, pixel_PRO=0.554, train_loss_epoch=4.03e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.06it/s]
Epoch 13: 100%|██████████| 1/1 [00:06<00:00,  0.15it/s, train_loss_step=2.12e+4, pixel_AUROC=0.801, pixel_PRO=0.560, train_loss_epoch=3.09e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.05it/s]
Epoch 14: 100%|██████████| 1/1 [00:06<00:00,  0.16it/s, train_loss_step=1.2e+4, pixel_AUROC=0.820, pixel_PRO=0.562, train_loss_epoch=2.12e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.27it/s]
Epoch 15: 100%|██████████| 1/1 [00:06<00:00,  0.16it/s, train_loss_step=5.57e+3, pixel_AUROC=0.809, pixel_PRO=0.552, train_loss_epoch=1.2e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.70it/s]
Epoch 16: 100%|██████████| 1/1 [00:06<00:00,  0.16it/s, train_loss_step=-1.88e+3, pixel_AUROC=0.834, pixel_PRO=0.569, train_loss_epoch=5.57e+3]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.99it/s]
Epoch 17: 100%|██████████| 1/1 [00:06<00:00,  0.16it/s, train_loss_step=-8.6e+3, pixel_AUROC=0.824, pixel_PRO=0.554, train_loss_epoch=-1.88e+3]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.50it/s]
Epoch 18: 100%|██████████| 1/1 [00:06<00:00,  0.15it/s, train_loss_step=-1.55e+4, pixel_AUROC=0.820, pixel_PRO=0.547, train_loss_epoch=-8.6e+3]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.52it/s]
Epoch 19: 100%|██████████| 1/1 [00:06<00:00,  0.15it/s, train_loss_step=-2.27e+4, pixel_AUROC=0.843, pixel_PRO=0.563, train_loss_epoch=-1.55e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.09it/s]
Epoch 20: 100%|██████████| 1/1 [00:06<00:00,  0.15it/s, train_loss_step=-2.77e+4, pixel_AUROC=0.842, pixel_PRO=0.563, train_loss_epoch=-2.27e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.94it/s]
Epoch 21: 100%|██████████| 1/1 [00:06<00:00,  0.15it/s, train_loss_step=-3.4e+4, pixel_AUROC=0.843, pixel_PRO=0.569, train_loss_epoch=-2.77e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.10it/s]
Epoch 22: 100%|██████████| 1/1 [00:06<00:00,  0.15it/s, train_loss_step=-4.05e+4, pixel_AUROC=0.854, pixel_PRO=0.584, train_loss_epoch=-3.4e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.45it/s]
Epoch 23: 100%|██████████| 1/1 [00:06<00:00,  0.15it/s, train_loss_step=-4.59e+4, pixel_AUROC=0.860, pixel_PRO=0.591, train_loss_epoch=-4.05e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.08it/s]
Epoch 24: 100%|██████████| 1/1 [00:06<00:00,  0.15it/s, train_loss_step=-5.27e+4, pixel_AUROC=0.865, pixel_PRO=0.593, train_loss_epoch=-4.59e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.87it/s]
Epoch 25: 100%|██████████| 1/1 [00:06<00:00,  0.15it/s, train_loss_step=-5.78e+4, pixel_AUROC=0.863, pixel_PRO=0.592, train_loss_epoch=-5.27e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.98it/s]
Epoch 26: 100%|██████████| 1/1 [00:06<00:00,  0.16it/s, train_loss_step=-6.35e+4, pixel_AUROC=0.864, pixel_PRO=0.587, train_loss_epoch=-5.78e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.97it/s]
Epoch 27: 100%|██████████| 1/1 [00:06<00:00,  0.15it/s, train_loss_step=-6.78e+4, pixel_AUROC=0.867, pixel_PRO=0.600, train_loss_epoch=-6.35e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.88it/s]
Epoch 28: 100%|██████████| 1/1 [00:06<00:00,  0.15it/s, train_loss_step=-7.33e+4, pixel_AUROC=0.876, pixel_PRO=0.603, train_loss_epoch=-6.78e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.07it/s]
Epoch 29: 100%|██████████| 1/1 [00:06<00:00,  0.15it/s, train_loss_step=-7.78e+4, pixel_AUROC=0.873, pixel_PRO=0.600, train_loss_epoch=-7.33e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.06it/s]
Epoch 30: 100%|██████████| 1/1 [00:06<00:00,  0.15it/s, train_loss_step=-8.24e+4, pixel_AUROC=0.878, pixel_PRO=0.594, train_loss_epoch=-7.78e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.70it/s]
Epoch 31: 100%|██████████| 1/1 [00:06<00:00,  0.15it/s, train_loss_step=-8.65e+4, pixel_AUROC=0.879, pixel_PRO=0.597, train_loss_epoch=-8.24e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.07it/s]
Epoch 32: 100%|██████████| 1/1 [00:06<00:00,  0.15it/s, train_loss_step=-9.03e+4, pixel_AUROC=0.884, pixel_PRO=0.612, train_loss_epoch=-8.65e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.14it/s]
Epoch 33: 100%|██████████| 1/1 [00:06<00:00,  0.16it/s, train_loss_step=-9.51e+4, pixel_AUROC=0.889, pixel_PRO=0.614, train_loss_epoch=-9.03e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.12it/s]
Epoch 34: 100%|██████████| 1/1 [00:06<00:00,  0.16it/s, train_loss_step=-1e+5, pixel_AUROC=0.888, pixel_PRO=0.612, train_loss_epoch=-9.51e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.03it/s]
Epoch 35: 100%|██████████| 1/1 [00:06<00:00,  0.16it/s, train_loss_step=-1.06e+5, pixel_AUROC=0.893, pixel_PRO=0.616, train_loss_epoch=-1e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.85it/s]
Epoch 36: 100%|██████████| 1/1 [00:06<00:00,  0.16it/s, train_loss_step=-1.1e+5, pixel_AUROC=0.894, pixel_PRO=0.621, train_loss_epoch=-1.06e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.12it/s]
Epoch 37: 100%|██████████| 1/1 [00:06<00:00,  0.16it/s, train_loss_step=-1.15e+5, pixel_AUROC=0.892, pixel_PRO=0.606, train_loss_epoch=-1.1e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.11it/s]
Epoch 38: 100%|██████████| 1/1 [00:06<00:00,  0.16it/s, train_loss_step=-1.19e+5, pixel_AUROC=0.894, pixel_PRO=0.609, train_loss_epoch=-1.15e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.13it/s]
Epoch 39: 100%|██████████| 1/1 [00:06<00:00,  0.16it/s, train_loss_step=-1.24e+5, pixel_AUROC=0.896, pixel_PRO=0.615, train_loss_epoch=-1.19e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.10it/s]
Epoch 40: 100%|██████████| 1/1 [00:06<00:00,  0.16it/s, train_loss_step=-1.29e+5, pixel_AUROC=0.900, pixel_PRO=0.619, train_loss_epoch=-1.24e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.02it/s]
Epoch 41: 100%|██████████| 1/1 [00:06<00:00,  0.16it/s, train_loss_step=-1.33e+5, pixel_AUROC=0.893, pixel_PRO=0.607, train_loss_epoch=-1.29e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.12it/s]
Epoch 42: 100%|██████████| 1/1 [00:06<00:00,  0.16it/s, train_loss_step=-1.37e+5, pixel_AUROC=0.895, pixel_PRO=0.610, train_loss_epoch=-1.33e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.79it/s]
Epoch 42: 100%|██████████| 1/1 [00:12<00:00,  0.08it/s, train_loss_step=-1.37e+5, pixel_AUROC=0.885, pixel_PRO=0.603, train_loss_epoch=-1.37e+5]
2024-05-08 12:51:48,353 - INFO - Training took 530.49 seconds
2024-05-08 12:51:48,353 - INFO - ================== Start testing for dataset: tile ==================
2024-05-08 12:51:48,354 - INFO - Found the dataset.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'test_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Testing DataLoader 0: 100%|██████████| 1/1 [00:20<00:00,  0.05it/s]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │     0.933621883392334     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.8851436972618103     │
│         pixel_PRO         │    0.6028928756713867     │
└───────────────────────────┴───────────────────────────┘
2024-05-08 12:52:12,075 - INFO - Testing took 23.56286382675171 seconds
Throughput (batch_size=256) : 4.96544057039306 FPS
2024-05-08 12:52:12,144 - INFO - ================== Processing dataset: wood ==================
2024-05-08 12:52:12,144 - INFO - Initializing Fastflow model.
2024-05-08 12:52:12,144 - INFO - ================== Start training for dataset: wood ==================
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-05-08 12:52:12,154 - WARNING - No implementation of `configure_transforms` was provided in the Lightning model. Using default transforms from the base class. This may not be suitable for your use case. Please override `configure_transforms` in your model.
2024-05-08 12:52:12,155 - INFO - Found the dataset.
2024-05-08 12:52:12,291 - INFO - Loading pretrained weights from url (https://download.pytorch.org/models/resnet18-5c106cde.pth)
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name                  | Type                     | Params
-------------------------------------------------------------------
0 | loss                  | FastflowLoss             | 0
1 | _transform            | Compose                  | 0
2 | normalization_metrics | MinMax                   | 0
3 | image_threshold       | F1AdaptiveThreshold      | 0
4 | pixel_threshold       | F1AdaptiveThreshold      | 0
5 | image_metrics         | AnomalibMetricCollection | 0
6 | pixel_metrics         | AnomalibMetricCollection | 0
7 | model                 | FastflowModel            | 7.7 M
-------------------------------------------------------------------
3.5 M     Trainable params
4.2 M     Non-trainable params
7.7 M     Total params
30.678    Total estimated model params size (MB)
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Epoch 0:   0%|          | 0/1 [00:00<?, ?it/s] /home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/core/module.py:494: You called `self.log('train_loss', ..., logger=True)` but have no logger configured. You can enable one by doing `Trainer(logger=ALogger(...))`
Epoch 0: 100%|██████████| 1/1 [00:09<00:00,  0.10it/s, train_loss_step=2.34e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.43it/s]
Epoch 1: 100%|██████████| 1/1 [00:09<00:00,  0.10it/s, train_loss_step=1.99e+5, pixel_AUROC=0.786, pixel_PRO=0.589, train_loss_epoch=2.34e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.81it/s]
Epoch 2: 100%|██████████| 1/1 [00:09<00:00,  0.10it/s, train_loss_step=1.71e+5, pixel_AUROC=0.838, pixel_PRO=0.649, train_loss_epoch=1.99e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.84it/s]
Epoch 3: 100%|██████████| 1/1 [00:09<00:00,  0.10it/s, train_loss_step=1.47e+5, pixel_AUROC=0.877, pixel_PRO=0.727, train_loss_epoch=1.71e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.86it/s]
Epoch 4: 100%|██████████| 1/1 [00:09<00:00,  0.10it/s, train_loss_step=1.23e+5, pixel_AUROC=0.874, pixel_PRO=0.717, train_loss_epoch=1.47e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.63it/s]
Epoch 5: 100%|██████████| 1/1 [00:09<00:00,  0.10it/s, train_loss_step=1.05e+5, pixel_AUROC=0.882, pixel_PRO=0.737, train_loss_epoch=1.23e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.83it/s]
Epoch 6: 100%|██████████| 1/1 [00:09<00:00,  0.10it/s, train_loss_step=8.6e+4, pixel_AUROC=0.896, pixel_PRO=0.766, train_loss_epoch=1.05e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.90it/s]
Epoch 7: 100%|██████████| 1/1 [00:09<00:00,  0.11it/s, train_loss_step=6.71e+4, pixel_AUROC=0.912, pixel_PRO=0.797, train_loss_epoch=8.6e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.90it/s]
Epoch 8: 100%|██████████| 1/1 [00:09<00:00,  0.11it/s, train_loss_step=5.02e+4, pixel_AUROC=0.922, pixel_PRO=0.819, train_loss_epoch=6.71e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.55it/s]
Epoch 9: 100%|██████████| 1/1 [00:09<00:00,  0.10it/s, train_loss_step=3.44e+4, pixel_AUROC=0.923, pixel_PRO=0.821, train_loss_epoch=5.02e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.85it/s]
Epoch 10: 100%|██████████| 1/1 [00:09<00:00,  0.10it/s, train_loss_step=2.08e+4, pixel_AUROC=0.926, pixel_PRO=0.823, train_loss_epoch=3.44e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.62it/s]
Epoch 11: 100%|██████████| 1/1 [00:09<00:00,  0.10it/s, train_loss_step=7.87e+3, pixel_AUROC=0.930, pixel_PRO=0.825, train_loss_epoch=2.08e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.82it/s]
Epoch 12: 100%|██████████| 1/1 [00:09<00:00,  0.11it/s, train_loss_step=-4.5e+3, pixel_AUROC=0.930, pixel_PRO=0.827, train_loss_epoch=7.87e+3]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.72it/s]
Epoch 13: 100%|██████████| 1/1 [00:09<00:00,  0.10it/s, train_loss_step=-1.55e+4, pixel_AUROC=0.933, pixel_PRO=0.832, train_loss_epoch=-4.5e+3]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.80it/s]
Epoch 14: 100%|██████████| 1/1 [00:09<00:00,  0.10it/s, train_loss_step=-2.55e+4, pixel_AUROC=0.934, pixel_PRO=0.838, train_loss_epoch=-1.55e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.89it/s]
Epoch 15: 100%|██████████| 1/1 [00:09<00:00,  0.10it/s, train_loss_step=-3.5e+4, pixel_AUROC=0.934, pixel_PRO=0.833, train_loss_epoch=-2.55e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.79it/s]
Epoch 16: 100%|██████████| 1/1 [00:09<00:00,  0.10it/s, train_loss_step=-4.38e+4, pixel_AUROC=0.937, pixel_PRO=0.836, train_loss_epoch=-3.5e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.79it/s]
Epoch 17: 100%|██████████| 1/1 [00:09<00:00,  0.10it/s, train_loss_step=-5.16e+4, pixel_AUROC=0.935, pixel_PRO=0.837, train_loss_epoch=-4.38e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.56it/s]
Epoch 18: 100%|██████████| 1/1 [00:09<00:00,  0.10it/s, train_loss_step=-5.89e+4, pixel_AUROC=0.935, pixel_PRO=0.835, train_loss_epoch=-5.16e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.79it/s]
Epoch 19: 100%|██████████| 1/1 [00:09<00:00,  0.10it/s, train_loss_step=-6.57e+4, pixel_AUROC=0.940, pixel_PRO=0.844, train_loss_epoch=-5.89e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.76it/s]
Epoch 20: 100%|██████████| 1/1 [00:09<00:00,  0.11it/s, train_loss_step=-7.29e+4, pixel_AUROC=0.938, pixel_PRO=0.837, train_loss_epoch=-6.57e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.57it/s]
Epoch 21: 100%|██████████| 1/1 [00:09<00:00,  0.10it/s, train_loss_step=-7.85e+4, pixel_AUROC=0.936, pixel_PRO=0.831, train_loss_epoch=-7.29e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.47it/s]
Epoch 22: 100%|██████████| 1/1 [00:09<00:00,  0.10it/s, train_loss_step=-8.35e+4, pixel_AUROC=0.941, pixel_PRO=0.839, train_loss_epoch=-7.85e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.80it/s]
Epoch 23: 100%|██████████| 1/1 [00:09<00:00,  0.10it/s, train_loss_step=-9.13e+4, pixel_AUROC=0.941, pixel_PRO=0.839, train_loss_epoch=-8.35e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.86it/s]
Epoch 24: 100%|██████████| 1/1 [00:09<00:00,  0.11it/s, train_loss_step=-9.54e+4, pixel_AUROC=0.940, pixel_PRO=0.835, train_loss_epoch=-9.13e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.79it/s]
Epoch 25: 100%|██████████| 1/1 [00:09<00:00,  0.10it/s, train_loss_step=-1.03e+5, pixel_AUROC=0.943, pixel_PRO=0.834, train_loss_epoch=-9.54e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.73it/s]
Epoch 26: 100%|██████████| 1/1 [00:09<00:00,  0.10it/s, train_loss_step=-1.1e+5, pixel_AUROC=0.944, pixel_PRO=0.834, train_loss_epoch=-1.03e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.68it/s]
Epoch 27: 100%|██████████| 1/1 [00:09<00:00,  0.10it/s, train_loss_step=-1.16e+5, pixel_AUROC=0.945, pixel_PRO=0.836, train_loss_epoch=-1.1e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.76it/s]
Epoch 28: 100%|██████████| 1/1 [00:09<00:00,  0.10it/s, train_loss_step=-1.21e+5, pixel_AUROC=0.944, pixel_PRO=0.843, train_loss_epoch=-1.16e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.71it/s]
Epoch 29: 100%|██████████| 1/1 [00:09<00:00,  0.10it/s, train_loss_step=-1.26e+5, pixel_AUROC=0.944, pixel_PRO=0.839, train_loss_epoch=-1.21e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.66it/s]
Epoch 30: 100%|██████████| 1/1 [00:10<00:00,  0.09it/s, train_loss_step=-1.32e+5, pixel_AUROC=0.946, pixel_PRO=0.841, train_loss_epoch=-1.26e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.86it/s]
Epoch 31: 100%|██████████| 1/1 [00:09<00:00,  0.11it/s, train_loss_step=-1.37e+5, pixel_AUROC=0.945, pixel_PRO=0.840, train_loss_epoch=-1.32e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.87it/s]
Epoch 32: 100%|██████████| 1/1 [00:09<00:00,  0.10it/s, train_loss_step=-1.42e+5, pixel_AUROC=0.945, pixel_PRO=0.831, train_loss_epoch=-1.37e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.95it/s]
Epoch 32: 100%|██████████| 1/1 [00:14<00:00,  0.07it/s, train_loss_step=-1.42e+5, pixel_AUROC=0.945, pixel_PRO=0.839, train_loss_epoch=-1.42e+5]
2024-05-08 13:00:18,682 - INFO - Training took 486.28 seconds
2024-05-08 13:00:18,682 - INFO - ================== Start testing for dataset: wood ==================
2024-05-08 13:00:18,684 - INFO - Found the dataset.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'test_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Testing DataLoader 0: 100%|██████████| 1/1 [00:14<00:00,  0.07it/s]
2024-05-08 13:00:36,532 - INFO - Testing took 17.705865621566772 seconds
Throughput (batch_size=256) : 4.461798236160417 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.9815789461135864     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.9453082084655762     │
│         pixel_PRO         │    0.8389685750007629     │
└───────────────────────────┴───────────────────────────┘
2024-05-08 13:00:36,587 - INFO - ================== Processing dataset: zipper ==================
2024-05-08 13:00:36,587 - INFO - Initializing Fastflow model.
2024-05-08 13:00:36,587 - INFO - ================== Start training for dataset: zipper ==================
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-05-08 13:00:36,598 - WARNING - No implementation of `configure_transforms` was provided in the Lightning model. Using default transforms from the base class. This may not be suitable for your use case. Please override `configure_transforms` in your model.
2024-05-08 13:00:36,598 - INFO - Found the dataset.
2024-05-08 13:00:36,723 - INFO - Loading pretrained weights from url (https://download.pytorch.org/models/resnet18-5c106cde.pth)
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name                  | Type                     | Params
-------------------------------------------------------------------
0 | loss                  | FastflowLoss             | 0
1 | _transform            | Compose                  | 0
2 | normalization_metrics | MinMax                   | 0
3 | image_threshold       | F1AdaptiveThreshold      | 0
4 | pixel_threshold       | F1AdaptiveThreshold      | 0
5 | image_metrics         | AnomalibMetricCollection | 0
6 | pixel_metrics         | AnomalibMetricCollection | 0
7 | model                 | FastflowModel            | 7.7 M
-------------------------------------------------------------------
3.5 M     Trainable params
4.2 M     Non-trainable params
7.7 M     Total params
30.678    Total estimated model params size (MB)
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Epoch 0:   0%|          | 0/1 [00:00<?, ?it/s] /home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/core/module.py:494: You called `self.log('train_loss', ..., logger=True)` but have no logger configured. You can enable one by doing `Trainer(logger=ALogger(...))`
Epoch 0: 100%|██████████| 1/1 [00:05<00:00,  0.18it/s, train_loss_step=2.38e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.24it/s]
Epoch 1: 100%|██████████| 1/1 [00:05<00:00,  0.19it/s, train_loss_step=2.05e+5, pixel_AUROC=0.718, pixel_PRO=0.524, train_loss_epoch=2.38e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.28it/s]
Epoch 2: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=1.76e+5, pixel_AUROC=0.766, pixel_PRO=0.499, train_loss_epoch=2.05e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.23it/s]
Epoch 3: 100%|██████████| 1/1 [00:05<00:00,  0.18it/s, train_loss_step=1.52e+5, pixel_AUROC=0.825, pixel_PRO=0.431, train_loss_epoch=1.76e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.26it/s]
Epoch 4: 100%|██████████| 1/1 [00:05<00:00,  0.18it/s, train_loss_step=1.26e+5, pixel_AUROC=0.828, pixel_PRO=0.481, train_loss_epoch=1.52e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.28it/s]
Epoch 5: 100%|██████████| 1/1 [00:05<00:00,  0.19it/s, train_loss_step=1.04e+5, pixel_AUROC=0.835, pixel_PRO=0.503, train_loss_epoch=1.26e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.78it/s]
Epoch 6: 100%|██████████| 1/1 [00:05<00:00,  0.18it/s, train_loss_step=8.25e+4, pixel_AUROC=0.842, pixel_PRO=0.493, train_loss_epoch=1.04e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.85it/s]
Epoch 7: 100%|██████████| 1/1 [00:05<00:00,  0.17it/s, train_loss_step=5.92e+4, pixel_AUROC=0.851, pixel_PRO=0.481, train_loss_epoch=8.25e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.25it/s]
Epoch 8: 100%|██████████| 1/1 [00:05<00:00,  0.18it/s, train_loss_step=3.77e+4, pixel_AUROC=0.862, pixel_PRO=0.454, train_loss_epoch=5.92e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.94it/s]
Epoch 9: 100%|██████████| 1/1 [00:05<00:00,  0.18it/s, train_loss_step=1.84e+4, pixel_AUROC=0.880, pixel_PRO=0.481, train_loss_epoch=3.77e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.28it/s]
Epoch 10: 100%|██████████| 1/1 [00:05<00:00,  0.18it/s, train_loss_step=-871., pixel_AUROC=0.902, pixel_PRO=0.518, train_loss_epoch=1.84e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.24it/s]
Epoch 11: 100%|██████████| 1/1 [00:05<00:00,  0.19it/s, train_loss_step=-1.77e+4, pixel_AUROC=0.911, pixel_PRO=0.490, train_loss_epoch=-871.]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.24it/s]
Epoch 12: 100%|██████████| 1/1 [00:05<00:00,  0.18it/s, train_loss_step=-3.27e+4, pixel_AUROC=0.906, pixel_PRO=0.544, train_loss_epoch=-1.77e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.24it/s]
Epoch 13: 100%|██████████| 1/1 [00:05<00:00,  0.19it/s, train_loss_step=-4.78e+4, pixel_AUROC=0.900, pixel_PRO=0.532, train_loss_epoch=-3.27e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.98it/s]
Epoch 13: 100%|██████████| 1/1 [00:12<00:00,  0.08it/s, train_loss_step=-4.78e+4, pixel_AUROC=0.889, pixel_PRO=0.488, train_loss_epoch=-4.78e+4]
2024-05-08 13:03:28,810 - INFO - Training took 171.98 seconds
2024-05-08 13:03:28,810 - INFO - ================== Start testing for dataset: zipper ==================
2024-05-08 13:03:28,811 - INFO - Found the dataset.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Testing: |          | 0/? [00:00<?, ?it/s]/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'test_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Testing DataLoader 0: 100%|██████████| 1/1 [00:25<00:00,  0.04it/s]
2024-05-08 13:03:57,627 - INFO - Testing took 28.652923822402954 seconds
Throughput (batch_size=256) : 5.269968291401282 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.7268906831741333     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.8889991641044617     │
│         pixel_PRO         │    0.48770496249198914    │
└───────────────────────────┴───────────────────────────┘
2024-05-08 13:03:57,698 - INFO - ================== Processing dataset: cable ==================
2024-05-08 13:03:57,698 - INFO - Initializing Fastflow model.
2024-05-08 13:03:57,698 - INFO - ================== Start training for dataset: cable ==================
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-05-08 13:03:57,709 - WARNING - No implementation of `configure_transforms` was provided in the Lightning model. Using default transforms from the base class. This may not be suitable for your use case. Please override `configure_transforms` in your model.
2024-05-08 13:03:57,710 - INFO - Found the dataset.
2024-05-08 13:03:57,848 - INFO - Loading pretrained weights from url (https://download.pytorch.org/models/resnet18-5c106cde.pth)
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name                  | Type                     | Params
-------------------------------------------------------------------
0 | loss                  | FastflowLoss             | 0
1 | _transform            | Compose                  | 0
2 | normalization_metrics | MinMax                   | 0
3 | image_threshold       | F1AdaptiveThreshold      | 0
4 | pixel_threshold       | F1AdaptiveThreshold      | 0
5 | image_metrics         | AnomalibMetricCollection | 0
6 | pixel_metrics         | AnomalibMetricCollection | 0
7 | model                 | FastflowModel            | 7.7 M
-------------------------------------------------------------------
3.5 M     Trainable params
4.2 M     Non-trainable params
7.7 M     Total params
30.678    Total estimated model params size (MB)
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Epoch 0:   0%|          | 0/1 [00:00<?, ?it/s] /home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/core/module.py:494: You called `self.log('train_loss', ..., logger=True)` but have no logger configured. You can enable one by doing `Trainer(logger=ALogger(...))`
Epoch 0: 100%|██████████| 1/1 [00:08<00:00,  0.11it/s, train_loss_step=2.34e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.89it/s]
Epoch 1: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=2.14e+5, pixel_AUROC=0.645, pixel_PRO=0.425, train_loss_epoch=2.34e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.98it/s]
Epoch 2: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=1.98e+5, pixel_AUROC=0.679, pixel_PRO=0.439, train_loss_epoch=2.14e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.96it/s]
Epoch 3: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=1.85e+5, pixel_AUROC=0.714, pixel_PRO=0.462, train_loss_epoch=1.98e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.95it/s]
Epoch 4: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=1.72e+5, pixel_AUROC=0.720, pixel_PRO=0.453, train_loss_epoch=1.85e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.96it/s]
Epoch 5: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=1.6e+5, pixel_AUROC=0.714, pixel_PRO=0.455, train_loss_epoch=1.72e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.94it/s]
Epoch 6: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=1.49e+5, pixel_AUROC=0.709, pixel_PRO=0.465, train_loss_epoch=1.6e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  3.97it/s]
Epoch 6: 100%|██████████| 1/1 [00:17<00:00,  0.06it/s, train_loss_step=1.49e+5, pixel_AUROC=0.706, pixel_PRO=0.452, train_loss_epoch=1.49e+5]
2024-05-08 13:06:02,713 - INFO - Training took 124.76 seconds
2024-05-08 13:06:02,714 - INFO - ================== Start testing for dataset: cable ==================
2024-05-08 13:06:02,715 - INFO - Found the dataset.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Testing: |          | 0/? [00:00<?, ?it/s]/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'test_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Testing DataLoader 0: 100%|██████████| 1/1 [00:28<00:00,  0.04it/s]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.6761619448661804     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.7056825160980225     │
│         pixel_PRO         │    0.45197373628616333    │
└───────────────────────────┴───────────────────────────┘
2024-05-08 13:06:37,309 - INFO - Testing took 34.424872398376465 seconds
Throughput (batch_size=256) : 4.357314626010764 FPS
2024-05-08 13:06:37,382 - INFO - ================== Processing dataset: toothbrush ==================
2024-05-08 13:06:37,382 - INFO - Initializing Fastflow model.
2024-05-08 13:06:37,383 - INFO - ================== Start training for dataset: toothbrush ==================
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-05-08 13:06:37,403 - WARNING - No implementation of `configure_transforms` was provided in the Lightning model. Using default transforms from the base class. This may not be suitable for your use case. Please override `configure_transforms` in your model.
2024-05-08 13:06:37,404 - INFO - Found the dataset.
2024-05-08 13:06:37,538 - INFO - Loading pretrained weights from url (https://download.pytorch.org/models/resnet18-5c106cde.pth)
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name                  | Type                     | Params
-------------------------------------------------------------------
0 | loss                  | FastflowLoss             | 0
1 | _transform            | Compose                  | 0
2 | normalization_metrics | MinMax                   | 0
3 | image_threshold       | F1AdaptiveThreshold      | 0
4 | pixel_threshold       | F1AdaptiveThreshold      | 0
5 | image_metrics         | AnomalibMetricCollection | 0
6 | pixel_metrics         | AnomalibMetricCollection | 0
7 | model                 | FastflowModel            | 7.7 M
-------------------------------------------------------------------
3.5 M     Trainable params
4.2 M     Non-trainable params
7.7 M     Total params
30.678    Total estimated model params size (MB)
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Epoch 0:   0%|          | 0/1 [00:00<?, ?it/s] /home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/core/module.py:494: You called `self.log('train_loss', ..., logger=True)` but have no logger configured. You can enable one by doing `Trainer(logger=ALogger(...))`
Epoch 0: 100%|██████████| 1/1 [00:02<00:00,  0.42it/s, train_loss_step=2.36e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 10.49it/s]
Epoch 1: 100%|██████████| 1/1 [00:02<00:00,  0.41it/s, train_loss_step=2.09e+5, pixel_AUROC=0.823, pixel_PRO=0.572, train_loss_epoch=2.36e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 15.96it/s]
Epoch 2: 100%|██████████| 1/1 [00:02<00:00,  0.44it/s, train_loss_step=1.85e+5, pixel_AUROC=0.859, pixel_PRO=0.412, train_loss_epoch=2.09e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 16.12it/s]
Epoch 3: 100%|██████████| 1/1 [00:02<00:00,  0.42it/s, train_loss_step=1.6e+5, pixel_AUROC=0.888, pixel_PRO=0.354, train_loss_epoch=1.85e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 16.12it/s]
Epoch 4: 100%|██████████| 1/1 [00:02<00:00,  0.43it/s, train_loss_step=1.37e+5, pixel_AUROC=0.903, pixel_PRO=0.347, train_loss_epoch=1.6e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 14.61it/s]
Epoch 5: 100%|██████████| 1/1 [00:02<00:00,  0.42it/s, train_loss_step=1.11e+5, pixel_AUROC=0.914, pixel_PRO=0.349, train_loss_epoch=1.37e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 15.91it/s]
Epoch 6: 100%|██████████| 1/1 [00:02<00:00,  0.43it/s, train_loss_step=8.72e+4, pixel_AUROC=0.920, pixel_PRO=0.347, train_loss_epoch=1.11e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 14.89it/s]
Epoch 7: 100%|██████████| 1/1 [00:02<00:00,  0.43it/s, train_loss_step=6.34e+4, pixel_AUROC=0.921, pixel_PRO=0.331, train_loss_epoch=8.72e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 15.52it/s]
Epoch 8: 100%|██████████| 1/1 [00:02<00:00,  0.44it/s, train_loss_step=4.11e+4, pixel_AUROC=0.915, pixel_PRO=0.283, train_loss_epoch=6.34e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 14.99it/s]
Epoch 9: 100%|██████████| 1/1 [00:02<00:00,  0.43it/s, train_loss_step=1.85e+4, pixel_AUROC=0.926, pixel_PRO=0.270, train_loss_epoch=4.11e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 15.93it/s]
Epoch 10: 100%|██████████| 1/1 [00:02<00:00,  0.42it/s, train_loss_step=-4.02e+3, pixel_AUROC=0.930, pixel_PRO=0.265, train_loss_epoch=1.85e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 11.61it/s]
Epoch 11: 100%|██████████| 1/1 [00:02<00:00,  0.43it/s, train_loss_step=-2.47e+4, pixel_AUROC=0.928, pixel_PRO=0.275, train_loss_epoch=-4.02e+3]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 16.07it/s]
Epoch 12: 100%|██████████| 1/1 [00:02<00:00,  0.42it/s, train_loss_step=-4.64e+4, pixel_AUROC=0.938, pixel_PRO=0.269, train_loss_epoch=-2.47e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 16.07it/s]
Epoch 13: 100%|██████████| 1/1 [00:02<00:00,  0.43it/s, train_loss_step=-6.66e+4, pixel_AUROC=0.933, pixel_PRO=0.275, train_loss_epoch=-4.64e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 16.18it/s]
Epoch 14: 100%|██████████| 1/1 [00:02<00:00,  0.43it/s, train_loss_step=-8.77e+4, pixel_AUROC=0.936, pixel_PRO=0.280, train_loss_epoch=-6.66e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 16.09it/s]
Epoch 15: 100%|██████████| 1/1 [00:02<00:00,  0.42it/s, train_loss_step=-1.07e+5, pixel_AUROC=0.939, pixel_PRO=0.291, train_loss_epoch=-8.77e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 15.86it/s]
Epoch 16: 100%|██████████| 1/1 [00:02<00:00,  0.43it/s, train_loss_step=-1.26e+5, pixel_AUROC=0.934, pixel_PRO=0.278, train_loss_epoch=-1.07e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 14.09it/s]
Epoch 17: 100%|██████████| 1/1 [00:02<00:00,  0.43it/s, train_loss_step=-1.44e+5, pixel_AUROC=0.930, pixel_PRO=0.276, train_loss_epoch=-1.26e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00, 16.01it/s]
Epoch 17: 100%|██████████| 1/1 [00:04<00:00,  0.20it/s, train_loss_step=-1.44e+5, pixel_AUROC=0.906, pixel_PRO=0.260, train_loss_epoch=-1.44e+5]
2024-05-08 13:08:09,454 - INFO - Training took 91.81 seconds
2024-05-08 13:08:09,454 - INFO - ================== Start testing for dataset: toothbrush ==================
2024-05-08 13:08:09,455 - INFO - Found the dataset.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Testing: |          | 0/? [00:00<?, ?it/s]/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'test_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Testing DataLoader 0: 100%|██████████| 1/1 [00:07<00:00,  0.13it/s]
2024-05-08 13:08:19,062 - INFO - Testing took 9.575682878494263 seconds
Throughput (batch_size=256) : 4.386110163936875 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.7250000238418579     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.9058414697647095     │
│         pixel_PRO         │    0.2600979804992676     │
└───────────────────────────┴───────────────────────────┘
2024-05-08 13:08:19,107 - INFO - ================== Processing dataset: transistor ==================
2024-05-08 13:08:19,108 - INFO - Initializing Fastflow model.
2024-05-08 13:08:19,108 - INFO - ================== Start training for dataset: transistor ==================
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-05-08 13:08:19,118 - WARNING - No implementation of `configure_transforms` was provided in the Lightning model. Using default transforms from the base class. This may not be suitable for your use case. Please override `configure_transforms` in your model.
2024-05-08 13:08:19,118 - INFO - Found the dataset.
2024-05-08 13:08:19,266 - INFO - Loading pretrained weights from url (https://download.pytorch.org/models/resnet18-5c106cde.pth)
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name                  | Type                     | Params
-------------------------------------------------------------------
0 | loss                  | FastflowLoss             | 0
1 | _transform            | Compose                  | 0
2 | normalization_metrics | MinMax                   | 0
3 | image_threshold       | F1AdaptiveThreshold      | 0
4 | pixel_threshold       | F1AdaptiveThreshold      | 0
5 | image_metrics         | AnomalibMetricCollection | 0
6 | pixel_metrics         | AnomalibMetricCollection | 0
7 | model                 | FastflowModel            | 7.7 M
-------------------------------------------------------------------
3.5 M     Trainable params
4.2 M     Non-trainable params
7.7 M     Total params
30.678    Total estimated model params size (MB)
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Epoch 0:   0%|          | 0/1 [00:00<?, ?it/s] /home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/core/module.py:494: You called `self.log('train_loss', ..., logger=True)` but have no logger configured. You can enable one by doing `Trainer(logger=ALogger(...))`
Epoch 0: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=2.32e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.79it/s]
Epoch 1: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=2.08e+5, pixel_AUROC=0.529, pixel_PRO=0.648, train_loss_epoch=2.32e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.18it/s]
Epoch 2: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=1.88e+5, pixel_AUROC=0.555, pixel_PRO=0.659, train_loss_epoch=2.08e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.17it/s]
Epoch 3: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=1.72e+5, pixel_AUROC=0.584, pixel_PRO=0.587, train_loss_epoch=1.88e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.22it/s]
Epoch 4: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=1.56e+5, pixel_AUROC=0.600, pixel_PRO=0.445, train_loss_epoch=1.72e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.20it/s]
Epoch 5: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=1.4e+5, pixel_AUROC=0.607, pixel_PRO=0.513, train_loss_epoch=1.56e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.18it/s]
Epoch 6: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=1.26e+5, pixel_AUROC=0.615, pixel_PRO=0.426, train_loss_epoch=1.4e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.03it/s]
Epoch 7: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=1.12e+5, pixel_AUROC=0.626, pixel_PRO=0.392, train_loss_epoch=1.26e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.99it/s]
Epoch 8: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=9.85e+4, pixel_AUROC=0.639, pixel_PRO=0.384, train_loss_epoch=1.12e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.21it/s]
Epoch 9: 100%|██████████| 1/1 [00:08<00:00,  0.11it/s, train_loss_step=8.52e+4, pixel_AUROC=0.650, pixel_PRO=0.394, train_loss_epoch=9.85e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.26it/s]
Epoch 10: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=7.24e+4, pixel_AUROC=0.660, pixel_PRO=0.433, train_loss_epoch=8.52e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.20it/s]
Epoch 11: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=6e+4, pixel_AUROC=0.670, pixel_PRO=0.385, train_loss_epoch=7.24e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.17it/s]
Epoch 12: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=4.8e+4, pixel_AUROC=0.685, pixel_PRO=0.377, train_loss_epoch=6e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.21it/s]
Epoch 13: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=3.65e+4, pixel_AUROC=0.696, pixel_PRO=0.364, train_loss_epoch=4.8e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.27it/s]
Epoch 14: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=2.55e+4, pixel_AUROC=0.699, pixel_PRO=0.397, train_loss_epoch=3.65e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.20it/s]
Epoch 15: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=1.49e+4, pixel_AUROC=0.714, pixel_PRO=0.375, train_loss_epoch=2.55e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.18it/s]
Epoch 16: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=4.76e+3, pixel_AUROC=0.731, pixel_PRO=0.431, train_loss_epoch=1.49e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.24it/s]
Epoch 17: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-5.23e+3, pixel_AUROC=0.735, pixel_PRO=0.377, train_loss_epoch=4.76e+3]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.20it/s]
Epoch 18: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-1.52e+4, pixel_AUROC=0.759, pixel_PRO=0.426, train_loss_epoch=-5.23e+3]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.18it/s]
Epoch 19: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-2.49e+4, pixel_AUROC=0.763, pixel_PRO=0.405, train_loss_epoch=-1.52e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.17it/s]
Epoch 20: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-3.47e+4, pixel_AUROC=0.778, pixel_PRO=0.447, train_loss_epoch=-2.49e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.17it/s]
Epoch 21: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-4.37e+4, pixel_AUROC=0.774, pixel_PRO=0.424, train_loss_epoch=-3.47e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.16it/s]
Epoch 22: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-5.31e+4, pixel_AUROC=0.794, pixel_PRO=0.461, train_loss_epoch=-4.37e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.15it/s]
Epoch 23: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-6.2e+4, pixel_AUROC=0.798, pixel_PRO=0.461, train_loss_epoch=-5.31e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.14it/s]
Epoch 24: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-7.09e+4, pixel_AUROC=0.804, pixel_PRO=0.471, train_loss_epoch=-6.2e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.16it/s]
Epoch 25: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-7.95e+4, pixel_AUROC=0.816, pixel_PRO=0.463, train_loss_epoch=-7.09e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.15it/s]
Epoch 26: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-8.75e+4, pixel_AUROC=0.806, pixel_PRO=0.437, train_loss_epoch=-7.95e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.15it/s]
Epoch 27: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-9.45e+4, pixel_AUROC=0.832, pixel_PRO=0.492, train_loss_epoch=-8.75e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.16it/s]
Epoch 28: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-1.01e+5, pixel_AUROC=0.802, pixel_PRO=0.405, train_loss_epoch=-9.45e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.15it/s]
Epoch 29: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-1.08e+5, pixel_AUROC=0.808, pixel_PRO=0.414, train_loss_epoch=-1.01e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.16it/s]
Epoch 30: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-1.17e+5, pixel_AUROC=0.834, pixel_PRO=0.435, train_loss_epoch=-1.08e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.15it/s]
Epoch 31: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-1.26e+5, pixel_AUROC=0.835, pixel_PRO=0.434, train_loss_epoch=-1.17e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.16it/s]
Epoch 32: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-1.33e+5, pixel_AUROC=0.842, pixel_PRO=0.432, train_loss_epoch=-1.26e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.16it/s]
Epoch 33: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-1.4e+5, pixel_AUROC=0.848, pixel_PRO=0.437, train_loss_epoch=-1.33e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.16it/s]
Epoch 34: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-1.48e+5, pixel_AUROC=0.852, pixel_PRO=0.440, train_loss_epoch=-1.4e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.14it/s]
Epoch 35: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-1.55e+5, pixel_AUROC=0.864, pixel_PRO=0.439, train_loss_epoch=-1.48e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.15it/s]
Epoch 36: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-1.61e+5, pixel_AUROC=0.871, pixel_PRO=0.451, train_loss_epoch=-1.55e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.14it/s]
Epoch 37: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-1.69e+5, pixel_AUROC=0.874, pixel_PRO=0.456, train_loss_epoch=-1.61e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.14it/s]
Epoch 38: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-1.75e+5, pixel_AUROC=0.879, pixel_PRO=0.448, train_loss_epoch=-1.69e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.19it/s]
Epoch 39: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-1.82e+5, pixel_AUROC=0.883, pixel_PRO=0.458, train_loss_epoch=-1.75e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.16it/s]
Epoch 40: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-1.88e+5, pixel_AUROC=0.889, pixel_PRO=0.486, train_loss_epoch=-1.82e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.16it/s]
Epoch 41: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-1.95e+5, pixel_AUROC=0.891, pixel_PRO=0.485, train_loss_epoch=-1.88e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.16it/s]
Epoch 42: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-2.01e+5, pixel_AUROC=0.896, pixel_PRO=0.477, train_loss_epoch=-1.95e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.16it/s]
Epoch 43: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-2.08e+5, pixel_AUROC=0.900, pixel_PRO=0.506, train_loss_epoch=-2.01e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.32it/s]
Epoch 44: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-2.13e+5, pixel_AUROC=0.899, pixel_PRO=0.496, train_loss_epoch=-2.08e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.16it/s]
Epoch 45: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-2.2e+5, pixel_AUROC=0.904, pixel_PRO=0.503, train_loss_epoch=-2.13e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.13it/s]
Epoch 46: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-2.24e+5, pixel_AUROC=0.906, pixel_PRO=0.498, train_loss_epoch=-2.2e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.96it/s]
Epoch 47: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-2.3e+5, pixel_AUROC=0.909, pixel_PRO=0.520, train_loss_epoch=-2.24e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.15it/s]
Epoch 48: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-2.35e+5, pixel_AUROC=0.908, pixel_PRO=0.512, train_loss_epoch=-2.3e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.15it/s]
Epoch 49: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-2.41e+5, pixel_AUROC=0.915, pixel_PRO=0.509, train_loss_epoch=-2.35e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.16it/s]
Epoch 50: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-2.45e+5, pixel_AUROC=0.914, pixel_PRO=0.503, train_loss_epoch=-2.41e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.15it/s]
Epoch 51: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-2.51e+5, pixel_AUROC=0.917, pixel_PRO=0.525, train_loss_epoch=-2.45e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.15it/s]
Epoch 52: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-2.55e+5, pixel_AUROC=0.919, pixel_PRO=0.530, train_loss_epoch=-2.51e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.14it/s]
Epoch 53: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-2.59e+5, pixel_AUROC=0.916, pixel_PRO=0.506, train_loss_epoch=-2.55e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.16it/s]
Epoch 54: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-2.65e+5, pixel_AUROC=0.923, pixel_PRO=0.525, train_loss_epoch=-2.59e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.14it/s]
Epoch 55: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-2.68e+5, pixel_AUROC=0.916, pixel_PRO=0.527, train_loss_epoch=-2.65e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.15it/s]
Epoch 56: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-2.74e+5, pixel_AUROC=0.919, pixel_PRO=0.519, train_loss_epoch=-2.68e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.14it/s]
Epoch 57: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-2.78e+5, pixel_AUROC=0.929, pixel_PRO=0.544, train_loss_epoch=-2.74e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.17it/s]
Epoch 58: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-2.81e+5, pixel_AUROC=0.918, pixel_PRO=0.520, train_loss_epoch=-2.78e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.15it/s]
Epoch 59: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-2.85e+5, pixel_AUROC=0.924, pixel_PRO=0.537, train_loss_epoch=-2.81e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.16it/s]
Epoch 60: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-2.91e+5, pixel_AUROC=0.936, pixel_PRO=0.576, train_loss_epoch=-2.85e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.16it/s]
Epoch 61: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-2.95e+5, pixel_AUROC=0.928, pixel_PRO=0.552, train_loss_epoch=-2.91e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.03it/s]
Epoch 62: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-2.98e+5, pixel_AUROC=0.927, pixel_PRO=0.550, train_loss_epoch=-2.95e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.14it/s]
Epoch 62: 100%|██████████| 1/1 [00:14<00:00,  0.07it/s, train_loss_step=-2.98e+5, pixel_AUROC=0.935, pixel_PRO=0.550, train_loss_epoch=-2.98e+5]
2024-05-08 13:23:40,767 - INFO - Training took 921.40 seconds
2024-05-08 13:23:40,767 - INFO - ================== Start testing for dataset: transistor ==================
2024-05-08 13:23:40,768 - INFO - Found the dataset.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'test_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Testing DataLoader 0: 100%|██████████| 1/1 [00:18<00:00,  0.05it/s]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.8962499499320984     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.9354093670845032     │
│         pixel_PRO         │    0.5501736402511597     │
└───────────────────────────┴───────────────────────────┘
2024-05-08 13:24:03,675 - INFO - Testing took 22.75814461708069 seconds
Throughput (batch_size=256) : 4.394031309782034 FPS
2024-05-08 13:24:03,737 - INFO - ================== Processing dataset: metal_nut ==================
2024-05-08 13:24:03,737 - INFO - Initializing Fastflow model.
2024-05-08 13:24:03,737 - INFO - ================== Start training for dataset: metal_nut ==================
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-05-08 13:24:03,747 - WARNING - No implementation of `configure_transforms` was provided in the Lightning model. Using default transforms from the base class. This may not be suitable for your use case. Please override `configure_transforms` in your model.
2024-05-08 13:24:03,747 - INFO - Found the dataset.
2024-05-08 13:24:03,891 - INFO - Loading pretrained weights from url (https://download.pytorch.org/models/resnet18-5c106cde.pth)
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name                  | Type                     | Params
-------------------------------------------------------------------
0 | loss                  | FastflowLoss             | 0
1 | _transform            | Compose                  | 0
2 | normalization_metrics | MinMax                   | 0
3 | image_threshold       | F1AdaptiveThreshold      | 0
4 | pixel_threshold       | F1AdaptiveThreshold      | 0
5 | image_metrics         | AnomalibMetricCollection | 0
6 | pixel_metrics         | AnomalibMetricCollection | 0
7 | model                 | FastflowModel            | 7.7 M
-------------------------------------------------------------------
3.5 M     Trainable params
4.2 M     Non-trainable params
7.7 M     Total params
30.678    Total estimated model params size (MB)
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Epoch 0:   0%|          | 0/1 [00:00<?, ?it/s] /home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/core/module.py:494: You called `self.log('train_loss', ..., logger=True)` but have no logger configured. You can enable one by doing `Trainer(logger=ALogger(...))`
Epoch 0: 100%|██████████| 1/1 [00:04<00:00,  0.25it/s, train_loss_step=2.33e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.65it/s]
Epoch 1: 100%|██████████| 1/1 [00:04<00:00,  0.25it/s, train_loss_step=2.08e+5, pixel_AUROC=0.672, pixel_PRO=0.895, train_loss_epoch=2.33e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.49it/s]
Epoch 2: 100%|██████████| 1/1 [00:04<00:00,  0.25it/s, train_loss_step=1.88e+5, pixel_AUROC=0.702, pixel_PRO=0.875, train_loss_epoch=2.08e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.73it/s]
Epoch 3: 100%|██████████| 1/1 [00:04<00:00,  0.25it/s, train_loss_step=1.69e+5, pixel_AUROC=0.730, pixel_PRO=0.867, train_loss_epoch=1.88e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.74it/s]
Epoch 4: 100%|██████████| 1/1 [00:04<00:00,  0.25it/s, train_loss_step=1.52e+5, pixel_AUROC=0.751, pixel_PRO=0.863, train_loss_epoch=1.69e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.70it/s]
Epoch 5: 100%|██████████| 1/1 [00:04<00:00,  0.25it/s, train_loss_step=1.35e+5, pixel_AUROC=0.768, pixel_PRO=0.858, train_loss_epoch=1.52e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.10it/s]
Epoch 6: 100%|██████████| 1/1 [00:03<00:00,  0.25it/s, train_loss_step=1.19e+5, pixel_AUROC=0.781, pixel_PRO=0.837, train_loss_epoch=1.35e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.69it/s]
Epoch 7: 100%|██████████| 1/1 [00:04<00:00,  0.25it/s, train_loss_step=1.04e+5, pixel_AUROC=0.791, pixel_PRO=0.835, train_loss_epoch=1.19e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.76it/s]
Epoch 8: 100%|██████████| 1/1 [00:04<00:00,  0.25it/s, train_loss_step=8.87e+4, pixel_AUROC=0.799, pixel_PRO=0.826, train_loss_epoch=1.04e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.75it/s]
Epoch 9: 100%|██████████| 1/1 [00:04<00:00,  0.25it/s, train_loss_step=7.33e+4, pixel_AUROC=0.807, pixel_PRO=0.813, train_loss_epoch=8.87e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.78it/s]
Epoch 10: 100%|██████████| 1/1 [00:04<00:00,  0.25it/s, train_loss_step=5.81e+4, pixel_AUROC=0.816, pixel_PRO=0.797, train_loss_epoch=7.33e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.69it/s]
Epoch 11: 100%|██████████| 1/1 [00:04<00:00,  0.25it/s, train_loss_step=4.34e+4, pixel_AUROC=0.824, pixel_PRO=0.774, train_loss_epoch=5.81e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.77it/s]
Epoch 12: 100%|██████████| 1/1 [00:04<00:00,  0.25it/s, train_loss_step=2.95e+4, pixel_AUROC=0.830, pixel_PRO=0.767, train_loss_epoch=4.34e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.79it/s]
Epoch 13: 100%|██████████| 1/1 [00:04<00:00,  0.25it/s, train_loss_step=1.6e+4, pixel_AUROC=0.834, pixel_PRO=0.757, train_loss_epoch=2.95e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.78it/s]
Epoch 14: 100%|██████████| 1/1 [00:04<00:00,  0.25it/s, train_loss_step=3.18e+3, pixel_AUROC=0.835, pixel_PRO=0.745, train_loss_epoch=1.6e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.46it/s]
Epoch 15: 100%|██████████| 1/1 [00:04<00:00,  0.25it/s, train_loss_step=-9.32e+3, pixel_AUROC=0.833, pixel_PRO=0.742, train_loss_epoch=3.18e+3]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.30it/s]
Epoch 16: 100%|██████████| 1/1 [00:04<00:00,  0.25it/s, train_loss_step=-2.19e+4, pixel_AUROC=0.837, pixel_PRO=0.738, train_loss_epoch=-9.32e+3]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.77it/s]
Epoch 17: 100%|██████████| 1/1 [00:04<00:00,  0.25it/s, train_loss_step=-3.29e+4, pixel_AUROC=0.816, pixel_PRO=0.715, train_loss_epoch=-2.19e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.72it/s]
Epoch 18: 100%|██████████| 1/1 [00:04<00:00,  0.25it/s, train_loss_step=-4.25e+4, pixel_AUROC=0.846, pixel_PRO=0.750, train_loss_epoch=-3.29e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.73it/s]
Epoch 19: 100%|██████████| 1/1 [00:04<00:00,  0.25it/s, train_loss_step=-5.39e+4, pixel_AUROC=0.842, pixel_PRO=0.734, train_loss_epoch=-4.25e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.75it/s]
Epoch 20: 100%|██████████| 1/1 [00:04<00:00,  0.25it/s, train_loss_step=-6.27e+4, pixel_AUROC=0.799, pixel_PRO=0.694, train_loss_epoch=-5.39e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.77it/s]
Epoch 20: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-6.27e+4, pixel_AUROC=0.841, pixel_PRO=0.741, train_loss_epoch=-6.27e+4]
2024-05-08 13:27:06,777 - INFO - Training took 182.78 seconds
2024-05-08 13:27:06,777 - INFO - ================== Start testing for dataset: metal_nut ==================
2024-05-08 13:27:06,778 - INFO - Found the dataset.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'test_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Testing DataLoader 0: 100%|██████████| 1/1 [00:20<00:00,  0.05it/s]
2024-05-08 13:27:28,985 - INFO - Testing took 22.053004264831543 seconds
Throughput (batch_size=256) : 5.2147090083047445 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.8132942318916321     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.8413756489753723     │
│         pixel_PRO         │    0.7410144805908203     │
└───────────────────────────┴───────────────────────────┘
2024-05-08 13:27:29,049 - INFO - ================== Processing dataset: bottle ==================
2024-05-08 13:27:29,049 - INFO - Initializing Fastflow model.
2024-05-08 13:27:29,050 - INFO - ================== Start training for dataset: bottle ==================
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-05-08 13:27:29,060 - WARNING - No implementation of `configure_transforms` was provided in the Lightning model. Using default transforms from the base class. This may not be suitable for your use case. Please override `configure_transforms` in your model.
2024-05-08 13:27:29,060 - INFO - Found the dataset.
2024-05-08 13:27:29,206 - INFO - Loading pretrained weights from url (https://download.pytorch.org/models/resnet18-5c106cde.pth)
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name                  | Type                     | Params
-------------------------------------------------------------------
0 | loss                  | FastflowLoss             | 0
1 | _transform            | Compose                  | 0
2 | normalization_metrics | MinMax                   | 0
3 | image_threshold       | F1AdaptiveThreshold      | 0
4 | pixel_threshold       | F1AdaptiveThreshold      | 0
5 | image_metrics         | AnomalibMetricCollection | 0
6 | pixel_metrics         | AnomalibMetricCollection | 0
7 | model                 | FastflowModel            | 7.7 M
-------------------------------------------------------------------
3.5 M     Trainable params
4.2 M     Non-trainable params
7.7 M     Total params
30.678    Total estimated model params size (MB)
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Epoch 0:   0%|          | 0/1 [00:00<?, ?it/s] /home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/core/module.py:494: You called `self.log('train_loss', ..., logger=True)` but have no logger configured. You can enable one by doing `Trainer(logger=ALogger(...))`
Epoch 0: 100%|██████████| 1/1 [00:05<00:00,  0.19it/s, train_loss_step=2.36e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.02it/s]
Epoch 1: 100%|██████████| 1/1 [00:05<00:00,  0.19it/s, train_loss_step=2.07e+5, pixel_AUROC=0.591, pixel_PRO=0.347, train_loss_epoch=2.36e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.49it/s]
Epoch 2: 100%|██████████| 1/1 [00:05<00:00,  0.19it/s, train_loss_step=1.83e+5, pixel_AUROC=0.673, pixel_PRO=0.445, train_loss_epoch=2.07e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.51it/s]
Epoch 3: 100%|██████████| 1/1 [00:05<00:00,  0.19it/s, train_loss_step=1.63e+5, pixel_AUROC=0.737, pixel_PRO=0.517, train_loss_epoch=1.83e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.51it/s]
Epoch 4: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=1.43e+5, pixel_AUROC=0.766, pixel_PRO=0.556, train_loss_epoch=1.63e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.46it/s]
Epoch 5: 100%|██████████| 1/1 [00:05<00:00,  0.19it/s, train_loss_step=1.25e+5, pixel_AUROC=0.786, pixel_PRO=0.586, train_loss_epoch=1.43e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.27it/s]
Epoch 6: 100%|██████████| 1/1 [00:05<00:00,  0.19it/s, train_loss_step=1.09e+5, pixel_AUROC=0.799, pixel_PRO=0.589, train_loss_epoch=1.25e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.32it/s]
Epoch 7: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=9.17e+4, pixel_AUROC=0.808, pixel_PRO=0.587, train_loss_epoch=1.09e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.44it/s]
Epoch 8: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=7.41e+4, pixel_AUROC=0.820, pixel_PRO=0.596, train_loss_epoch=9.17e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.48it/s]
Epoch 9: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=5.71e+4, pixel_AUROC=0.840, pixel_PRO=0.624, train_loss_epoch=7.41e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.41it/s]
Epoch 10: 100%|██████████| 1/1 [00:05<00:00,  0.19it/s, train_loss_step=4.06e+4, pixel_AUROC=0.857, pixel_PRO=0.652, train_loss_epoch=5.71e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.41it/s]
Epoch 11: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=2.46e+4, pixel_AUROC=0.869, pixel_PRO=0.659, train_loss_epoch=4.06e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  7.76it/s]
Epoch 12: 100%|██████████| 1/1 [00:05<00:00,  0.19it/s, train_loss_step=9.46e+3, pixel_AUROC=0.884, pixel_PRO=0.684, train_loss_epoch=2.46e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.46it/s]
Epoch 13: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=-6.69e+3, pixel_AUROC=0.891, pixel_PRO=0.684, train_loss_epoch=9.46e+3]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.47it/s]
Epoch 14: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=-2.03e+4, pixel_AUROC=0.890, pixel_PRO=0.670, train_loss_epoch=-6.69e+3]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.47it/s]
Epoch 15: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=-3.32e+4, pixel_AUROC=0.917, pixel_PRO=0.721, train_loss_epoch=-2.03e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.44it/s]
Epoch 16: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=-4.64e+4, pixel_AUROC=0.923, pixel_PRO=0.729, train_loss_epoch=-3.32e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.40it/s]
Epoch 17: 100%|██████████| 1/1 [00:05<00:00,  0.19it/s, train_loss_step=-6.12e+4, pixel_AUROC=0.932, pixel_PRO=0.737, train_loss_epoch=-4.64e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.46it/s]
Epoch 18: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=-7.49e+4, pixel_AUROC=0.938, pixel_PRO=0.745, train_loss_epoch=-6.12e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.51it/s]
Epoch 19: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=-8.78e+4, pixel_AUROC=0.938, pixel_PRO=0.750, train_loss_epoch=-7.49e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.39it/s]
Epoch 20: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=-9.91e+4, pixel_AUROC=0.939, pixel_PRO=0.741, train_loss_epoch=-8.78e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.46it/s]
Epoch 21: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=-1.11e+5, pixel_AUROC=0.948, pixel_PRO=0.752, train_loss_epoch=-9.91e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.41it/s]
Epoch 22: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=-1.23e+5, pixel_AUROC=0.954, pixel_PRO=0.757, train_loss_epoch=-1.11e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.46it/s]
Epoch 23: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=-1.35e+5, pixel_AUROC=0.957, pixel_PRO=0.764, train_loss_epoch=-1.23e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.46it/s]
Epoch 24: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=-1.45e+5, pixel_AUROC=0.960, pixel_PRO=0.783, train_loss_epoch=-1.35e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.44it/s]
Epoch 25: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=-1.57e+5, pixel_AUROC=0.964, pixel_PRO=0.794, train_loss_epoch=-1.45e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.47it/s]
Epoch 26: 100%|██████████| 1/1 [00:05<00:00,  0.19it/s, train_loss_step=-1.66e+5, pixel_AUROC=0.963, pixel_PRO=0.792, train_loss_epoch=-1.57e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.50it/s]
Epoch 27: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=-1.75e+5, pixel_AUROC=0.964, pixel_PRO=0.795, train_loss_epoch=-1.66e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.49it/s]
Epoch 28: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=-1.85e+5, pixel_AUROC=0.968, pixel_PRO=0.801, train_loss_epoch=-1.75e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.48it/s]
Epoch 29: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=-1.93e+5, pixel_AUROC=0.966, pixel_PRO=0.780, train_loss_epoch=-1.85e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.45it/s]
Epoch 30: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=-2.05e+5, pixel_AUROC=0.970, pixel_PRO=0.787, train_loss_epoch=-1.93e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.45it/s]
Epoch 31: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=-2.13e+5, pixel_AUROC=0.970, pixel_PRO=0.792, train_loss_epoch=-2.05e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.46it/s]
Epoch 32: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=-2.21e+5, pixel_AUROC=0.969, pixel_PRO=0.791, train_loss_epoch=-2.13e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.41it/s]
Epoch 33: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=-2.29e+5, pixel_AUROC=0.970, pixel_PRO=0.797, train_loss_epoch=-2.21e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.52it/s]
Epoch 34: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=-2.37e+5, pixel_AUROC=0.970, pixel_PRO=0.797, train_loss_epoch=-2.29e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.51it/s]
Epoch 35: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=-2.44e+5, pixel_AUROC=0.971, pixel_PRO=0.804, train_loss_epoch=-2.37e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.40it/s]
Epoch 36: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=-2.51e+5, pixel_AUROC=0.970, pixel_PRO=0.797, train_loss_epoch=-2.44e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.48it/s]
Epoch 37: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=-2.59e+5, pixel_AUROC=0.972, pixel_PRO=0.799, train_loss_epoch=-2.51e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.45it/s]
Epoch 38: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=-2.67e+5, pixel_AUROC=0.971, pixel_PRO=0.794, train_loss_epoch=-2.59e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.46it/s]
Epoch 39: 100%|██████████| 1/1 [00:05<00:00,  0.20it/s, train_loss_step=-2.77e+5, pixel_AUROC=0.972, pixel_PRO=0.797, train_loss_epoch=-2.67e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  8.48it/s]
Epoch 39: 100%|██████████| 1/1 [00:08<00:00,  0.11it/s, train_loss_step=-2.77e+5, pixel_AUROC=0.970, pixel_PRO=0.793, train_loss_epoch=-2.77e+5]
2024-05-08 13:33:33,221 - INFO - Training took 363.91 seconds
2024-05-08 13:33:33,221 - INFO - ================== Start testing for dataset: bottle ==================
2024-05-08 13:33:33,222 - INFO - Found the dataset.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'test_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Testing DataLoader 0: 100%|██████████| 1/1 [00:13<00:00,  0.07it/s]
2024-05-08 13:33:49,072 - INFO - Testing took 15.704077005386353 seconds
Throughput (batch_size=256) : 5.28525171976244 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.9968253970146179     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.9704914689064026     │
│         pixel_PRO         │    0.7928833961486816     │
└───────────────────────────┴───────────────────────────┘
2024-05-08 13:33:49,128 - INFO - ================== Processing dataset: hazelnut ==================
2024-05-08 13:33:49,128 - INFO - Initializing Fastflow model.
2024-05-08 13:33:49,129 - INFO - ================== Start training for dataset: hazelnut ==================
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-05-08 13:33:49,139 - WARNING - No implementation of `configure_transforms` was provided in the Lightning model. Using default transforms from the base class. This may not be suitable for your use case. Please override `configure_transforms` in your model.
2024-05-08 13:33:49,139 - INFO - Found the dataset.
2024-05-08 13:33:49,280 - INFO - Loading pretrained weights from url (https://download.pytorch.org/models/resnet18-5c106cde.pth)
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name                  | Type                     | Params
-------------------------------------------------------------------
0 | loss                  | FastflowLoss             | 0
1 | _transform            | Compose                  | 0
2 | normalization_metrics | MinMax                   | 0
3 | image_threshold       | F1AdaptiveThreshold      | 0
4 | pixel_threshold       | F1AdaptiveThreshold      | 0
5 | image_metrics         | AnomalibMetricCollection | 0
6 | pixel_metrics         | AnomalibMetricCollection | 0
7 | model                 | FastflowModel            | 7.7 M
-------------------------------------------------------------------
3.5 M     Trainable params
4.2 M     Non-trainable params
7.7 M     Total params
30.678    Total estimated model params size (MB)
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Epoch 0:   0%|          | 0/2 [00:00<?, ?it/s] /home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/core/module.py:494: You called `self.log('train_loss', ..., logger=True)` but have no logger configured. You can enable one by doing `Trainer(logger=ALogger(...))`
Epoch 0: 100%|██████████| 2/2 [00:14<00:00,  0.14it/s, train_loss_step=2.07e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.93it/s]
Epoch 1: 100%|██████████| 2/2 [00:14<00:00,  0.13it/s, train_loss_step=1.6e+5, pixel_AUROC=0.937, pixel_PRO=0.679, train_loss_epoch=2.26e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.46it/s]
Epoch 2: 100%|██████████| 2/2 [00:14<00:00,  0.14it/s, train_loss_step=1.17e+5, pixel_AUROC=0.949, pixel_PRO=0.703, train_loss_epoch=1.75e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.74it/s]
Epoch 3: 100%|██████████| 2/2 [00:14<00:00,  0.14it/s, train_loss_step=7.76e+4, pixel_AUROC=0.949, pixel_PRO=0.739, train_loss_epoch=1.31e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.49it/s]
Epoch 4: 100%|██████████| 2/2 [00:14<00:00,  0.14it/s, train_loss_step=4.06e+4, pixel_AUROC=0.944, pixel_PRO=0.726, train_loss_epoch=8.99e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  6.51it/s]
Epoch 4: 100%|██████████| 2/2 [00:20<00:00,  0.10it/s, train_loss_step=4.06e+4, pixel_AUROC=0.938, pixel_PRO=0.729, train_loss_epoch=5.3e+4]
2024-05-08 13:35:35,165 - INFO - Training took 105.78 seconds
2024-05-08 13:35:35,166 - INFO - ================== Start testing for dataset: hazelnut ==================
2024-05-08 13:35:35,167 - INFO - Found the dataset.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'test_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Testing DataLoader 0: 100%|██████████| 1/1 [00:19<00:00,  0.05it/s]
2024-05-08 13:35:59,015 - INFO - Testing took 23.69747281074524 seconds
Throughput (batch_size=256) : 4.641845182331943 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.7985714077949524     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.9378423690795898     │
│         pixel_PRO         │    0.7287378311157227     │
└───────────────────────────┴───────────────────────────┘
2024-05-08 13:35:59,079 - INFO - ================== Processing dataset: leather ==================
2024-05-08 13:35:59,079 - INFO - Initializing Fastflow model.
2024-05-08 13:35:59,079 - INFO - ================== Start training for dataset: leather ==================
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-05-08 13:35:59,089 - WARNING - No implementation of `configure_transforms` was provided in the Lightning model. Using default transforms from the base class. This may not be suitable for your use case. Please override `configure_transforms` in your model.
2024-05-08 13:35:59,090 - INFO - Found the dataset.
2024-05-08 13:35:59,212 - INFO - Loading pretrained weights from url (https://download.pytorch.org/models/resnet18-5c106cde.pth)
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name                  | Type                     | Params
-------------------------------------------------------------------
0 | loss                  | FastflowLoss             | 0
1 | _transform            | Compose                  | 0
2 | normalization_metrics | MinMax                   | 0
3 | image_threshold       | F1AdaptiveThreshold      | 0
4 | pixel_threshold       | F1AdaptiveThreshold      | 0
5 | image_metrics         | AnomalibMetricCollection | 0
6 | pixel_metrics         | AnomalibMetricCollection | 0
7 | model                 | FastflowModel            | 7.7 M
-------------------------------------------------------------------
3.5 M     Trainable params
4.2 M     Non-trainable params
7.7 M     Total params
30.678    Total estimated model params size (MB)
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Epoch 0:   0%|          | 0/1 [00:00<?, ?it/s] /home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/core/module.py:494: You called `self.log('train_loss', ..., logger=True)` but have no logger configured. You can enable one by doing `Trainer(logger=ALogger(...))`
Epoch 0: 100%|██████████| 1/1 [00:07<00:00,  0.13it/s, train_loss_step=2.36e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.96it/s]
Epoch 1: 100%|██████████| 1/1 [00:07<00:00,  0.13it/s, train_loss_step=1.96e+5, pixel_AUROC=0.869, pixel_PRO=0.252, train_loss_epoch=2.36e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.98it/s]
Epoch 2: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=1.6e+5, pixel_AUROC=0.934, pixel_PRO=0.361, train_loss_epoch=1.96e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.99it/s]
Epoch 3: 100%|██████████| 1/1 [00:07<00:00,  0.13it/s, train_loss_step=1.31e+5, pixel_AUROC=0.968, pixel_PRO=0.505, train_loss_epoch=1.6e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.69it/s]
Epoch 4: 100%|██████████| 1/1 [00:07<00:00,  0.13it/s, train_loss_step=1.03e+5, pixel_AUROC=0.969, pixel_PRO=0.492, train_loss_epoch=1.31e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.75it/s]
Epoch 5: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=8.12e+4, pixel_AUROC=0.975, pixel_PRO=0.599, train_loss_epoch=1.03e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.52it/s]
Epoch 6: 100%|██████████| 1/1 [00:07<00:00,  0.13it/s, train_loss_step=5.87e+4, pixel_AUROC=0.983, pixel_PRO=0.668, train_loss_epoch=8.12e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.00it/s]
Epoch 7: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=3.74e+4, pixel_AUROC=0.988, pixel_PRO=0.692, train_loss_epoch=5.87e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.99it/s]
Epoch 8: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=1.49e+4, pixel_AUROC=0.989, pixel_PRO=0.703, train_loss_epoch=3.74e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.86it/s]
Epoch 9: 100%|██████████| 1/1 [00:07<00:00,  0.13it/s, train_loss_step=-3.72e+3, pixel_AUROC=0.991, pixel_PRO=0.743, train_loss_epoch=1.49e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.96it/s]
Epoch 10: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-2.42e+4, pixel_AUROC=0.991, pixel_PRO=0.750, train_loss_epoch=-3.72e+3]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.00it/s]
Epoch 11: 100%|██████████| 1/1 [00:07<00:00,  0.13it/s, train_loss_step=-4.19e+4, pixel_AUROC=0.992, pixel_PRO=0.807, train_loss_epoch=-2.42e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.99it/s]
Epoch 12: 100%|██████████| 1/1 [00:07<00:00,  0.13it/s, train_loss_step=-5.76e+4, pixel_AUROC=0.993, pixel_PRO=0.807, train_loss_epoch=-4.19e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.97it/s]
Epoch 13: 100%|██████████| 1/1 [00:07<00:00,  0.13it/s, train_loss_step=-7.26e+4, pixel_AUROC=0.993, pixel_PRO=0.805, train_loss_epoch=-5.76e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.00it/s]
Epoch 14: 100%|██████████| 1/1 [00:07<00:00,  0.13it/s, train_loss_step=-8.52e+4, pixel_AUROC=0.994, pixel_PRO=0.813, train_loss_epoch=-7.26e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.97it/s]
Epoch 15: 100%|██████████| 1/1 [00:07<00:00,  0.13it/s, train_loss_step=-9.67e+4, pixel_AUROC=0.994, pixel_PRO=0.805, train_loss_epoch=-8.52e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.00it/s]
Epoch 16: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-1.07e+5, pixel_AUROC=0.994, pixel_PRO=0.831, train_loss_epoch=-9.67e+4]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.02it/s]
Epoch 17: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-1.18e+5, pixel_AUROC=0.995, pixel_PRO=0.829, train_loss_epoch=-1.07e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.04it/s]
Epoch 18: 100%|██████████| 1/1 [00:07<00:00,  0.13it/s, train_loss_step=-1.28e+5, pixel_AUROC=0.995, pixel_PRO=0.824, train_loss_epoch=-1.18e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.02it/s]
Epoch 19: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-1.37e+5, pixel_AUROC=0.995, pixel_PRO=0.851, train_loss_epoch=-1.28e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.01it/s]
Epoch 20: 100%|██████████| 1/1 [00:07<00:00,  0.13it/s, train_loss_step=-1.44e+5, pixel_AUROC=0.995, pixel_PRO=0.844, train_loss_epoch=-1.37e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.98it/s]
Epoch 21: 100%|██████████| 1/1 [00:07<00:00,  0.13it/s, train_loss_step=-1.53e+5, pixel_AUROC=0.995, pixel_PRO=0.838, train_loss_epoch=-1.44e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.04it/s]
Epoch 22: 100%|██████████| 1/1 [00:07<00:00,  0.13it/s, train_loss_step=-1.59e+5, pixel_AUROC=0.995, pixel_PRO=0.839, train_loss_epoch=-1.53e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.01it/s]
Epoch 23: 100%|██████████| 1/1 [00:07<00:00,  0.13it/s, train_loss_step=-1.68e+5, pixel_AUROC=0.995, pixel_PRO=0.828, train_loss_epoch=-1.59e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.02it/s]
Epoch 24: 100%|██████████| 1/1 [00:07<00:00,  0.13it/s, train_loss_step=-1.74e+5, pixel_AUROC=0.995, pixel_PRO=0.848, train_loss_epoch=-1.68e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.02it/s]
Epoch 25: 100%|██████████| 1/1 [00:07<00:00,  0.13it/s, train_loss_step=-1.82e+5, pixel_AUROC=0.995, pixel_PRO=0.836, train_loss_epoch=-1.74e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.02it/s]
Epoch 26: 100%|██████████| 1/1 [00:07<00:00,  0.13it/s, train_loss_step=-1.89e+5, pixel_AUROC=0.995, pixel_PRO=0.835, train_loss_epoch=-1.82e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.98it/s]
Epoch 27: 100%|██████████| 1/1 [00:07<00:00,  0.13it/s, train_loss_step=-1.95e+5, pixel_AUROC=0.996, pixel_PRO=0.835, train_loss_epoch=-1.89e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.01it/s]
Epoch 28: 100%|██████████| 1/1 [00:07<00:00,  0.13it/s, train_loss_step=-1.99e+5, pixel_AUROC=0.996, pixel_PRO=0.839, train_loss_epoch=-1.95e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.01it/s]
Epoch 29: 100%|██████████| 1/1 [00:08<00:00,  0.12it/s, train_loss_step=-2e+5, pixel_AUROC=0.996, pixel_PRO=0.837, train_loss_epoch=-1.99e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.99it/s]
Epoch 30: 100%|██████████| 1/1 [00:07<00:00,  0.13it/s, train_loss_step=-2.07e+5, pixel_AUROC=0.996, pixel_PRO=0.833, train_loss_epoch=-2e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  4.98it/s]
Epoch 31: 100%|██████████| 1/1 [00:07<00:00,  0.13it/s, train_loss_step=-2.14e+5, pixel_AUROC=0.996, pixel_PRO=0.837, train_loss_epoch=-2.07e+5]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100%|██████████| 1/1 [00:00<00:00,  5.01it/s]
Epoch 31: 100%|██████████| 1/1 [00:14<00:00,  0.07it/s, train_loss_step=-2.14e+5, pixel_AUROC=0.996, pixel_PRO=0.837, train_loss_epoch=-2.14e+5]
2024-05-08 13:44:05,571 - INFO - Training took 486.25 seconds
2024-05-08 13:44:05,571 - INFO - ================== Start testing for dataset: leather ==================
2024-05-08 13:44:05,572 - INFO - Found the dataset.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home/jinyao/anaconda3/envs/IADB/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:441: The 'test_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Testing DataLoader 0: 100%|██████████| 1/1 [00:21<00:00,  0.05it/s]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.9989809989929199     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.9955794215202332     │
│         pixel_PRO         │    0.8367173075675964     │
└───────────────────────────┴───────────────────────────┘
2024-05-08 13:44:31,788 - INFO - Testing took 26.059197664260864 seconds
Throughput (batch_size=256) : 4.758396693466161 FPS

Process finished with exit code 0
